<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta property="og:locale" content="en_US">
    <meta name="content-language" content="en_US">

    
    <title>origen_link</title>
    <meta property="og:title" content="origen_link">
    <meta name="twitter:title" content="origen_link">
    <meta itemprop="name" content="origen_link">
      
  
  
  
  
    <meta property="og:image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta name="twitter:image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta itemprop="image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta name="twitter:card" content="summary">
  
  
  

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://origen-sdk.org/css/bootstrap_custom.css"></script>
    <!-- Load this up top to allow pages to execute JQuery snippets -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="http://origen-sdk.org/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://origen-sdk.org/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://origen-sdk.org/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://origen-sdk.org/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://origen-sdk.org/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://origen-sdk.org/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://origen-sdk.org/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://origen-sdk.org/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="http://origen-sdk.org/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="http://origen-sdk.org/manifest.json">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
  </head>

  <body>
    
      <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/OrigenLink/">Home</a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li class=""><a href="/OrigenLink/api/">API</a></li>
        <li class=""><a href="/OrigenLink/release_notes">Release Notes</a></li>
      </ul>
<a href="http://origen-sdk.org" class=" pull-right">
  <img src="http://origen-sdk.org/img/origen-device.png" style="height:30px; margin-top: 10px;">
  <img src="http://origen-sdk.org/img/origen-text.png" style="height:15px; margin-top: 10px; margin-left: 5px;">
</a>

    </div>
<!--/.nav-collapse -->
  </div>
</nav>

<div class="row">
  <div class="span12">

    <h1>OrigenLink <span style="font-size: 14px">(0.3.0)</span>
</h1>

    <div>    
  <a class="anchor" name="Purpose"></a>          
  <h1><a href="#Purpose">Purpose</a></h1>          
</div>

    <p>This is a plug-in for Origen that enables live silicon debug directly from origen source.  There are 2 parts to OrigenLink, the plug-in and the server.  Setup for each is documented separately.  The OrigenLink server is capable of being shared by multiple people working on the same project.  It will lock out other users during your debug or pattern execution session.</p>

    <div>    
  <a class="anchor" name="Plug-in"></a>          
  <h1><a href="#Plug-in">Plug-in</a></h1>          
</div>

    <p>Instructions for integrating and using the plug-in with your app.</p>

    <div>    
  <a class="anchor" name="How_To_Import"></a>          
  <h2><a href="#How_To_Import">How To Import</a></h2>          
</div>

    <ul>
      <li>Add the following line to your application’s GEMFILE:</li>
    </ul>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre> gem <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">origen_link</span><span style="color:#710">'</span></span>
</pre></div>
</div>
    </div>

    <ul>
      <li>Add a link environment (./environment/link.rb).  See server setup section for more information:</li>
    </ul>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># Note that the field for providing the computer name or IP address is a string</span>
<span style="color:#036;font-weight:bold">OrigenLink</span>::<span style="color:#036;font-weight:bold">VectorBased</span>.new(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">&lt;ServerComputerName -- or IP_Address&gt;</span><span style="color:#710">'</span></span>, <span style="color:#00D">12777</span>)
</pre></div>
</div>
    </div>

    <ul>
      <li>Select link as your environment to run a pattern over the link connection when the origen generate command is run:</li>
    </ul>

    <pre><code>origen e environment/link.rb
origen g pattern/my_pattern.rb
</code></pre>

    <div>    
  <a class="anchor" name="How_To_Configure"></a>          
  <h2><a href="#How_To_Configure">How To Configure</a></h2>          
</div>

    <p>Before OrigenLink can be used the physical pin map and timing must be setup.  There are 2 supported ways of doing this.  The high-level setup method allows OrigenLink to determine how to configure the server side pin sequencer.  The high-level setup method is highly recommended.  For cases where the high-level setup is not functioning correctly, legacy apps, or if you just enjoy doing things the hard way, a legacy low-level api is available.  Both will be described here.</p>

    <div>    
  <a class="anchor" name="How_To_Configure_-_High-Level_Method_(Preferred)"></a>          
  <h3><a href="#How_To_Configure_-_High-Level_Method_(Preferred)">How To Configure - High-Level Method (Preferred)</a></h3>          
</div>

    <p>This is the recomended way to setup OrigenLink in your application.</p>

    <div>    
  <a class="anchor" name="Physical_Pin_Map"></a>          
  <h4><a href="#Physical_Pin_Map">Physical Pin Map</a></h4>          
</div>

    <p>OrigenLink needs to tell the server application which physical IO pin on the UDOO device (see UDOO-Neo GPIO documentation) corresponds to which DUT pin in your app.  The number after ‘gpio_’ is what OrigenLink needs.  This IO number is passed to OrigenLink through pin meta data.</p>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>add_pin <span style="color:#A60">:tclk</span>, <span style="color:#606">meta</span>: {<span style="color:#606">link_io</span>: <span style="color:#00D">8</span>}
add_pin <span style="color:#A60">:tdi</span>, <span style="color:#606">meta</span>: {<span style="color:#606">link_io</span>: <span style="color:#00D">146</span>}
</pre></div>
</div>
    </div>

    <div>    
  <a class="anchor" name="Timing"></a>          
  <h4><a href="#Timing">Timing</a></h4>          
</div>

    <p>OrigenLink emulates a tester sequencer through software.  The timing it implemtents will not be precise.  Setting the drive edge of tdi to 5ns and tclk to 20ns will not result in tclk being driven 15ns after tdi.  What will happen, though, is the sequencer will drive tdi first, followed by tclk.  It is recommended that you use the built in Origen API for setting timing.</p>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>  <span style="color:#777"># Configure timing for jtag communication with RL tclk</span>
  tester.set_timeset(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">api_tst</span><span style="color:#710">'</span></span>, <span style="color:#00D">40</span>)
  dut.timeset <span style="color:#A60">:api_tst</span> <span style="color:#080;font-weight:bold">do</span> |t|
    t.drive_wave <span style="color:#A60">:tclk</span> <span style="color:#080;font-weight:bold">do</span> |w|
      w.drive <span style="color:#A60">:data</span>, <span style="color:#606">at</span>: <span style="color:#00D">10</span>
      w.drive <span style="color:#00D">0</span>, <span style="color:#606">at</span>: <span style="color:#00D">30</span>
    <span style="color:#080;font-weight:bold">end</span>
    t.drive_wave <span style="color:#A60">:tdi</span>, <span style="color:#A60">:tms</span>, <span style="color:#A60">:tdo</span> <span style="color:#080;font-weight:bold">do</span> |w|
      w.drive <span style="color:#A60">:data</span>, <span style="color:#606">at</span>: <span style="color:#00D">5</span>
    <span style="color:#080;font-weight:bold">end</span>
    t.compare_wave <span style="color:#080;font-weight:bold">do</span> |w|
      w.compare <span style="color:#A60">:data</span>, <span style="color:#606">at</span>: <span style="color:#00D">25</span>
    <span style="color:#080;font-weight:bold">end</span>
  <span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
    </div>

    <div>    
  <a class="anchor" name="Finished"></a>          
  <h4><a href="#Finished">Finished</a></h4>          
</div>

    <p>Start your OrigenLink server (see server setup section), connect your DUT to the server device and off you go.</p>

    <div>    
  <a class="anchor" name="How_To_Configure_-_Low-Level_Legacy_API_(Skip_Reading_This_Section)"></a>          
  <h3><a href="#How_To_Configure_-_Low-Level_Legacy_API_(Skip_Reading_This_Section)">How To Configure - Low-Level Legacy API (Skip Reading This Section)</a></h3>          
</div>

    <p>The prefered configuration method is above.  These methods for configuring the server application are supported for legacy applications.  This method is more prone to producing hard to debug errors during setup of a new app.</p>

    <div>    
  <a class="anchor" name="Low-Level_Physical_Pin_Map_Setup"></a>          
  <h4><a href="#Low-Level_Physical_Pin_Map_Setup">Low-Level Physical Pin Map Setup</a></h4>          
</div>

    <p>Create a comma separated list of pin_name and IO# and pass it to the tester.  The .pinmap method will clear all server settings.  So, this should be done first.  The pin name string provided to the pinmap must exactly match the pin name string provided to the pin timing and pin order methods.  Any typo may result strange behavior (pin operation not occuring, timing error messages, and/or server crash).  No cause for alarm, just be sure to check for consistent names if you get those problems.</p>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>  tester.pinmap = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">tclk,119,tms,6,tdi,116,tdo,124</span><span style="color:#710">'</span></span>
</pre></div>
</div>
    </div>

    <div>    
  <a class="anchor" name="Low-Level_Pattern_Pin_Order_Setup"></a>          
  <h4><a href="#Low-Level_Pattern_Pin_Order_Setup">Low-Level Pattern Pin Order Setup</a></h4>          
</div>

    <p>Pins that don’t have an assiciated physical IO will not have their pin data transmitted to the link server.  Create a comma separated list of the pins that are linked (only include pins that are in the pinmap) in the order that they appear in the pattern.  Using this command is not needed unless you used the low-level pin map setup command AND your dut.pins(:pin_name) doesn’t match the pin name that you setup using ‘tester.pinmap =’.</p>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>  pin_pattern_order <span style="color:#A60">:tclk</span>, <span style="color:#A60">:tms</span>, <span style="color:#A60">:tdi</span>, <span style="color:#A60">:tdo</span>        <span style="color:#777"># This sets the order of the pins in the pattern</span>

  <span style="color:#777"># order given below must match order in pin_pattern_order</span>
  <span style="color:#777"># names used below must match names used in tester.pinmap=</span>
  <span style="color:#777"># the below example will cause issues because of a typo: 'tck' versus 'tclk' (tester.pinmap = 'tclk,119,)</span>
  tester.pinorder = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">tck,tms,tdi,tdo</span><span style="color:#710">'</span></span>                <span style="color:#777"># This tells the server what order the pins are in the pattern</span>
</pre></div>
</div>
    </div>

    <div>    
  <a class="anchor" name="Low-Level_Timing_Setup"></a>          
  <h4><a href="#Low-Level_Timing_Setup">Low-Level Timing Setup</a></h4>          
</div>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>    <span style="color:#777"># pinformat=</span>
    <span style="color:#777">#   This method is used to setup the pin clock format on the debugger device.</span>
    <span style="color:#777">#   The supported formats are rl and rh</span>
    <span style="color:#777">#</span>
    <span style="color:#777">#   example:</span>
    <span style="color:#777">#     tester.pinformat = 'func_25mhz,tclk,rl'</span>

    <span style="color:#777"># pintiming=</span>
    <span style="color:#777">#   This method is used to setup the pin timing on the debugger device.</span>
    <span style="color:#777">#   Timing is relative to the rise and fall of a clock</span>
    <span style="color:#777">#</span>
    <span style="color:#777">#   timing value:         0   1   2</span>
    <span style="color:#777">#   clock waveform:      ___/***___</span>
    <span style="color:#777">#</span>
    <span style="color:#777">#   example:</span>
    <span style="color:#777">#     tester.pintiming = 'func_25mhz,tms,0,tdi,0,tdo,1'</span>

</pre></div>
</div>
    </div>

    <div>    
  <a class="anchor" name="Debugging_Your_App"></a>          
  <h3><a href="#Debugging_Your_App">Debugging Your App</a></h3>          
</div>

    <p>What follows are some pointers for using OrigenLink to debug your app (or pattern).  Run the origen pattern generation command with debug enabled and set a break point in your code to interactively debug.</p>

    <pre><code>origen g pattern/my_pattern.rb -d
</code></pre>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>  <span style="color:#777"># inside pattern/my_pattern.rb</span>

  dut.reg(<span style="color:#A60">:MyReg</span>).write!(my_value)

  <span style="color:#777"># stop after updating this register to observe device state</span>
  debugger        <span style="color:#777"># generation of the pattern will pause here</span>
</pre></div>
</div>
    </div>

    <div>    
  <a class="anchor" name="Debugging_Pin_Map"></a>          
  <h4><a href="#Debugging_Pin_Map">Debugging Pin Map</a></h4>          
</div>

    <p>There are pin methods available to aid debug of an OrigenLink setup.</p>

    <pre><code>  # Cause a pin to continuously toggle every 2 seconds
  (debugger prompt): dut.pin(:tdi).hello
  
  # Stop the pin from toggling
  (debugger prompt): dut.pin(:tdi).goodbye
</code></pre>

    <div>    
  <a class="anchor" name="Staying_Synchronized"></a>          
  <h4><a href="#Staying_Synchronized">Staying Synchronized</a></h4>          
</div>

    <p>For efficiency vectors that are generated by your app are compressed and stored until the pattern generation is completed.  This means that when execution reaches a ‘debugger’ statement the previously generated vectors may not have been sent to the server yet.  There are a handful of ways to make this happen.</p>

    <ul>
      <li>Use the tester.synchronize command from the debugger interface:</li>
    </ul>

    <pre><code>  # one time synchronize
  (debugger prompt): tester.synchronize

  # tell debugger to evaluate the synchronize command every time it gets control
  # will cause continuous synchronization
  (debugger prompt): disp tester.synchronize
</code></pre>

    <ul>
      <li>Use tester.transaction (makes the most sense to have this in your app’s reg read/write methods).  Before the transaction method executes the code block provided it will perform a synchronization.  Then, the code in the block is executed (which generates new vectors) and a second synchronization is performed.  The transaction method returns a boolean indicating whether the vectors generated by the code block passed or failed.</li>
    </ul>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>  result = tester.transaction { dut.jtag.shift_xx (yy) }
  <span style="color:#080;font-weight:bold">if</span> tester.link?
    <span style="color:#777"># result = true if the code in the provided block passed</span>
  <span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
    </div>

    <div>    
  <a class="anchor" name="Capturing_DUT_Information"></a>          
  <h4><a href="#Capturing_DUT_Information">Capturing DUT Information</a></h4>          
</div>

    <p>There are a few methods for observing the actual state of the DUT.</p>

    <ul>
      <li>Capture using tester.capture</li>
    </ul>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>  <span style="color:#777"># example of capturing and programatically using information read from the DUT</span>
  ss <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">reading default ID</span><span style="color:#710">"</span></span>
  dut.reg(<span style="color:#A60">:testreg</span>).bits(<span style="color:#00D">31</span>..<span style="color:#00D">0</span>).store
  default_id = tester.capture {dut.jtag.read_dr dut.reg(<span style="color:#A60">:testreg</span>), <span style="color:#606">size</span>: <span style="color:#00D">32</span> }
  default_id_str = default_id[<span style="color:#00D">0</span>].to_s(<span style="color:#00D">2</span>)
  default_id_str.reverse!
  default_id = default_id_str.to_i(<span style="color:#00D">2</span>)
  puts <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">**************************************************</span><span style="color:#710">'</span></span>
  puts <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Captured default ID through JTAG: 0x</span><span style="color:#710">'</span></span> + default_id.to_s(<span style="color:#00D">16</span>)
  puts <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">**************************************************</span><span style="color:#710">'</span></span>
</pre></div>
</div>
    </div>

    <ul>
      <li>Capture using mem api</li>
    </ul>

    <p>This command will read the contents of memory from the DUT and display it.</p>

    <pre><code>  # example of mem api use
  (debugger prompt): dut.mem(0x2000_0000).sync(3)
  20000000: DEADBEEF
  20000004: 200000D4
  20000008: 1C000898
  
  (debugger prompt): dut.mem(0x2000_0000).write!(0x1234567)
  (debugger prompt): dut.mem(0x2000_0000).sync(3)
  20000000: 01234567
  20000004: 200000D4
  20000008: 1C000898
</code></pre>

    <ul>
      <li>reg.sync!</li>
    </ul>

    <p>This command will read the contents of the register from the DUT and display it by bit field.</p>

    <pre><code>  (debugger prompt): dut.reg(:MyReg).sync! 
</code></pre>

    <div>    
  <a class="anchor" name="When_A_Shared_Server_Session_Isn%E2%80%99t_Properly_Ended"></a>          
  <h4><a href="#When_A_Shared_Server_Session_Isn%E2%80%99t_Properly_Ended">When A Shared Server Session Isn’t Properly Ended</a></h4>          
</div>

    <p>The server is able to handle multiple users.  Once a user connects to the server, it will only allow access from that same IP address and user name until the session has ended.  The session end command is transmitted when pattern generation is completed.  If a user fails to properly end their session (happens when you exit debug mode by typing ‘q’ instead of ‘c’), the server application will continue to lock out access until the time out has expired (20 minutes).  Before terminating a running session, check with the user who started the session to make sure they aren’t in the middle of debug (the user id and IP address will be displayed when you try to connect).  If the previous session needs to be manually terminated, this is how you do it (this should be a rare exception to the rule - it’s bad manners to forcefully kill another user’s session):</p>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># run this code to forcefully terminate a session</span>
require <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">socket</span><span style="color:#710">'</span></span>

<span style="color:#036;font-weight:bold">TCPSocket</span>.open(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">udooneo-computer-name</span><span style="color:#710">'</span></span>, <span style="color:#00D">12777</span>) <span style="color:#080;font-weight:bold">do</span> |link|
  link.puts(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">session_end</span><span style="color:#b0b">\n</span><span style="color:#b0b">\n</span><span style="color:#710">"</span></span>)
  <span style="color:#080;font-weight:bold">while</span> received = link.gets
    puts received
  <span style="color:#080;font-weight:bold">end</span>
  link.puts(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">session_kill</span><span style="color:#b0b">\n</span><span style="color:#b0b">\n</span><span style="color:#710">"</span></span>)
  <span style="color:#080;font-weight:bold">while</span> received = link.gets
    puts received
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>
puts <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">unlocked the server</span><span style="color:#710">"</span></span>
</pre></div>
</div>
    </div>

    <hr>

    <div>    
  <a class="anchor" name="Server"></a>          
  <h1><a href="#Server">Server</a></h1>          
</div>

    <p>This section describes how to setup a new IOT device to serve the OrigenLink pin sequencer.</p>

    <div>    
  <a class="anchor" name="Setting_Up_a_New_UDOO_device"></a>          
  <h2><a href="#Setting_Up_a_New_UDOO_device">Setting Up a New UDOO device</a></h2>          
</div>

    <p>Here are the steps to take to setup a new UDOO-Neo to run the OrigenLink server application.  These instructions are not intended to be exhaustive, but should be good enough to get you up and running.</p>

    <ul>
      <li>Change the name of the computer to something unique (like udooneo-myname).  This name is the string that you will enter in your environment ruby file for your app.  Your computer running origen g pattern/my_pattern.rb and the UDOO should be attached to the same network (either through USB or ethernet)</li>
    </ul>

    <pre><code>prompt$&gt; sudo nano /etc/hostname
</code></pre>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># Note that the field for providing the computer name or IP address is a string</span>
<span style="color:#036;font-weight:bold">OrigenLink</span>::<span style="color:#036;font-weight:bold">VectorBased</span>.new(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">&lt;ServerComputerName -- or IP_Address&gt;</span><span style="color:#710">'</span></span>, <span style="color:#00D">12777</span>)
</pre></div>
</div>
    </div>

    <ul>
      <li>Disable the M4 core (allows access to all IO’s from unix)</li>
    </ul>

    <pre><code>menu -&gt; preferences -&gt; Udoo web configuration -&gt; Advanced settings
</code></pre>

    <ul>
      <li>Install ruby.  This is a decision point.  If you want to install the OrigenLink gem, the steps are a bit more complicated.</li>
    </ul>

    <p>** Option 1 (I want the gem): You need to install ruby 2.2.</p>

    <pre><code>prompt$&gt; sudo apt-get ruby22
</code></pre>

    <p>** Option 2 (I’m fine using git to pull down the server code)</p>

    <pre><code># of course you're still welcomed to install a newer ruby version
# the server will run just fine
prompt$&gt; sudo apt-get ruby
</code></pre>

    <ul>
      <li>Install the OrigenLink server.</li>
    </ul>

    <p>** Option 1 (if you installed ruby22 you can do this).  Install origen and origen_link gems.</p>

    <pre><code># follow the instructions for installing origen at origen-sdk.org
prompt$&gt; sudo gem install origen
prompt$&gt; sudo gem install origen_link
</code></pre>

    <p>** Option 2 (This is what I do)</p>

    <pre><code>prompt$&gt; git clone https://github.com/Origen-SDK/OrigenLink.git

# if you get SSL certificate errors do this and retry the clone command
prompt$&gt; git config --global http.sslverify false
</code></pre>

    <div>    
  <a class="anchor" name="Starting_the_Server"></a>          
  <h2><a href="#Starting_the_Server">Starting the Server</a></h2>          
</div>

    <p>If you installed Ruby 2.x and Origen, run this command to start the server:</p>

    <pre><code>&lt;command_prompt&gt;$ start_link_server
</code></pre>

    <p>If you chose to clone the OrigenLink project from github, navigate to the OrigenLink directory and type this command:</p>

    <pre><code>&lt;command_prompt&gt;$ bin/start_link_server
</code></pre>

    <p>The server is now running</p>

    <div>    
  <a class="anchor" name="Physical_Interconnect"></a>          
  <h2><a href="#Physical_Interconnect">Physical Interconnect</a></h2>          
</div>

    <p>Keep the following things in mind when connecting the IO’s of your UDOO Neo to a DUT</p>

    <ul>
      <li>
        <p>Ground is important.  As a rule of thumb, connect at least 2 ground wires between the UDOO and your DUT</p>
      </li>
      <li>
        <p>Pay attention to pin levels.  The UDOO IO’s are 3.3v.  If your device is not also 3.3v, the most reliable and convenient way to connect the IO’s is by using a bi-directional (auto-direction sensing) level shifter.  This one works well and is easy to find (available on Amazon Prime at the writing of this document): TXB0108</p>
      </li>
      <li>
        <p>An alternative method for shifting a voltage down is to use a diode and pullup resistor.  The anode gets connected to the higher voltage device.  The cathode is connected to the lower voltage device.  A 10K pullup resistor is connected from the cathode to the supply voltage for the lower voltage device.  — A word of advice: This method is quick and easy.  But, you get a slow rise time which makes it a terrible way of shifting the level of a clock signal (like TCLK for JTAG or SPICLK for SPI).</p>
      </li>
    </ul>

    <hr>

    <div>    
  <a class="anchor" name="How_It_Works"></a>          
  <h1><a href="#How_It_Works">How It Works</a></h1>          
</div>

    <p>This section will explain the in’s and out’s of how the plug-in and server applications work and how they communicate.  This section is intended to aid developers who want to add or modify features.  More in depth information can be found in the api documentation.</p>

    <div>    
  <a class="anchor" name="Server_Side_App"></a>          
  <h2><a href="#Server_Side_App">Server Side App</a></h2>          
</div>

    <p>What follows is the structure of the server side app.</p>

    <div>    
  <a class="anchor" name="Pin_IO"></a>          
  <h3><a href="#Pin_IO">Pin IO</a></h3>          
</div>

    <p>Pin IO is accomplished by using the file objects exported by linux at \sys\class\gpio</p>

    <pre><code>&lt;command_prompt&gt;$ cd /sys/class/gpio

# export the file objects for a pin
&lt;command_prompt&gt;$ echo 20 &gt; export

# read the state of gpio20
&lt;command_prompt&gt;$ cd gpio20
&lt;command_prompt&gt;$ cat value

# drive gpio20 to logic 1
&lt;command_prompt&gt;$ echo out &gt; direction
&lt;command_prompt&gt;$ echo 1 &gt; value

# change gpio20 from output to input
&lt;command_prompt&gt;$ echo in &gt; direction
</code></pre>

    <div>    
  <a class="anchor" name="Pin_Class"></a>          
  <h3><a href="#Pin_Class">Pin Class</a></h3>          
</div>

    <p>The server pin class implements IO interactions for a pin.  When the pin assign command creates a pin object, it exports the associated IO number and opens IO objects for the direction and value of that pin.  The IO objects are kept open until the pin is destroyed.  For more information see the api documentation.</p>

    <div>    
  <a class="anchor" name="Pin_Sequencer"></a>          
  <h3><a href="#Pin_Sequencer">Pin Sequencer</a></h3>          
</div>

    <p>The pin sequencer is the class that does all of the heavy lifting for the server side app.  It implements all of the command messages that begin with “pin_”.  See the api documentation (Server::Sequencer) for more information.  Timing is perhaps the most complicated construct to understand:</p>

    <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>  <span style="color:#777"># tset is a number that corresponds to a timeset name from origen ex: 1 corresponds to 'tp0'</span>
  <span style="color:#777"># @cycletiming[tset] is a hash</span>
  <span style="color:#777"># each timeset contains these keys: </span>
  <span style="color:#777">#    'events'               -  [array of timestamps for timing events]</span>
  <span style="color:#777">#    'drive_event_data'     -  hash, the keys of the hash correspond to elements of 'events'</span>
  <span style="color:#777">#                           -  each value in the hash is an array</span>
  <span style="color:#777">#                           -  each element in the array is one of 3 values: 'data', '0', or '1'</span>
  <span style="color:#777">#    'drive_event_pins'     -  hash, the keys of the hash correspond to elements of 'events'</span>
  <span style="color:#777">#                           -  each value in the hash is an array</span>
  <span style="color:#777">#                           -  each element in the array is an array of pin objects</span>
  <span style="color:#777">#                           -  the drive event data will be performed for each pin object</span>
  <span style="color:#777">#    'compare_event_data'   -  similar to drive_event_data, the only valid event data is 'data'</span>
  <span style="color:#777">#    'compare_event_pins'     -  similar to drive_event_pins</span>
  
  <span style="color:#33B">@cycletiming</span>[tset] = {
  [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">events</span><span style="color:#710">'</span></span>] = [<span style="color:#00D">0</span>, <span style="color:#00D">5</span>, <span style="color:#00D">10</span>, <span style="color:#00D">35</span>]
  [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">drive_event_data</span><span style="color:#710">'</span></span>] = {
        <span style="color:#00D">0</span>: [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">data</span><span style="color:#710">'</span></span>]
       <span style="color:#00D">10</span>: [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">data</span><span style="color:#710">'</span></span>,<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">0</span><span style="color:#710">'</span></span>]
       <span style="color:#00D">35</span>: [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">0</span><span style="color:#710">'</span></span>]
      }
  [<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">drive_event_pins</span><span style="color:#710">'</span></span>] = {
        <span style="color:#00D">0</span>: [[pin_obj1, pin_obj2]]
       <span style="color:#00D">10</span>: [[pin1,pin2], [pin3]]
       <span style="color:#00D">35</span>: [[pin4]]
      }
  }
</pre></div>
</div>
    </div>

    <p>The main message supported by the sequencer is ‘pin_cycle’.  As the name implies, this message implements 1 or more cycles of vector data.  It will return the response of the dut to the plug-in side app along with pass/fail information.</p>

    <div>    
  <a class="anchor" name="Server"></a>          
  <h3><a href="#Server">Server</a></h3>          
</div>

    <p>The server serves a TCP socket at 12777.  No fancy gems are used for several reasons, the main one being simplicity.  Ruby has a built in socket library that is extremely simple to use.  Multiple messages from the plug-in side app can be received with a single connection.  “\n” indicates the end of a message.  “\n\n” indicates that the packet of messages has ended.  Why TCP and not UDP?  I know the web says that UDP socket communication is faster.  But, my testing indicated otherwise.  Plus, TCP is more reliable.</p>

  </div>
</div>


      </div><!-- /.container -->
    

    <footer class="footer">
      <div class="container">
        <p class="pull-left text-muted">
          Generated with the <a href="http://origen-sdk.org">Origen Semiconductor Developer's Kit</a>
        </p>
        <p class="pull-right text-muted">Origen is released under the terms of the <a href="http://choosealicense.com/licenses/lgpl-3.0/">LGPLv3</a></p>
      </div>
    </footer>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="http://origen-sdk.org/js/lunr.min.js"></script>
    <script src="http://origen-sdk.org/js/highlight.js"></script>
    <script src="http://origen-sdk.org/js/custom.js"></script>
    
  </body>
</html>
