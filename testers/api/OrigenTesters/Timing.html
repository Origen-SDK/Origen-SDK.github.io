<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: OrigenTesters::Timing
  
    &mdash; Origen Testers 0.7.10
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "OrigenTesters::Timing";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (T)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../OrigenTesters.html" title="OrigenTesters (module)">OrigenTesters</a></span></span>
     &raquo; 
    <span class="title">Timing</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="../class_list.html"></iframe>

      <div id="content"><h1>Module: OrigenTesters::Timing
  
  
  
</h1>
<div class="box_info">
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd>ActiveSupport::Concern</dd>
  </dl>
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="VectorBasedTester.html" title="OrigenTesters::VectorBasedTester (module)">VectorBasedTester</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/origen_testers/timing.rb</dd>
  </dl>
  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Timing/Timeset.html" title="OrigenTesters::Timing::Timeset (class)">Timeset</a></span>
    
  
</p>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#level_period-instance_method" title="#level_period (instance method)">#<strong>level_period</strong>  &#x21d2; Object </a>
    

    
      (also: #level_period?)
    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>When set to true all pattern vectors will be converted to use the same
period (the shortest period used in the pattern).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#timing_toggled_pins-instance_method" title="#timing_toggled_pins (instance method)">#<strong>timing_toggled_pins</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>When period levelling is enabled, vectors will be expanded like this:  
$tester.set_timeset(“fast”, 40)   2.cycles                        #    fast
1 0 0 1 0                                   #    fast   1 0 0 1 0   #
Without levelling enabled   $tester.set_timeset(“slow”, 80)   2.cycles     
#    slow   1 0 0 1 0                                   #    slow   1 0 0 1
0   # With levelling enabled   $tester.set_timeset(“slow”, 80)   2.cycles  
#    fast   1 0 0 1 0                                   #    fast   1 0 0 1
0                                   #    fast   1 0 0 1 0                  
#    fast   1 0 0 1 0.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#before_timeset_change-instance_method" title="#before_timeset_change (instance method)">#<strong>before_timeset_change</strong>(options = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#called_timesets-instance_method" title="#called_timesets (instance method)">#<strong>called_timesets</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#count-instance_method" title="#count (instance method)">#<strong>count</strong>(options = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This function can be used to generate a clock or some other repeating
function that spans accross a range of vectors.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_period_in_ns-instance_method" title="#current_period_in_ns (instance method)">#<strong>current_period_in_ns</strong>  &#x21d2; Object </a>
    

    
      (also: #current_period, #period)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_timeset-instance_method" title="#current_timeset (instance method)">#<strong>current_timeset</strong>  &#x21d2; Object </a>
    

    
      (also: #timeset)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cycles_to_time-instance_method" title="#cycles_to_time (instance method)">#<strong>cycles_to_time</strong>(cycles)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Convert the supplied number of cycles to a time, based on the SoC defined
cycle period.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delay-instance_method" title="#delay (instance method)">#<strong>delay</strong>(cycles, options = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
<p>This should not be called directly, call via tester#wait.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#max_repeat_loop-instance_method" title="#max_repeat_loop (instance method)">#<strong>max_repeat_loop</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#min_period_timeset-instance_method" title="#min_period_timeset (instance method)">#<strong>min_period_timeset</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the timeset (a Timeset object) with the shortest period that has
been encountered so far in the course of generating the current pattern.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#min_repeat_loop-instance_method" title="#min_repeat_loop (instance method)">#<strong>min_repeat_loop</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_timeset-instance_method" title="#set_timeset (instance method)">#<strong>set_timeset</strong>(timeset, period_in_ns = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set the timeset for the next vectors, this will remain in place until the
next time this is called.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeset_changed-instance_method" title="#timeset_changed (instance method)">#<strong>timeset_changed</strong>(timeset)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#wait-instance_method" title="#wait (instance method)">#<strong>wait</strong>(options = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Cause the pattern to wait.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="level_period=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="level_period-instance_method">
  
    #<strong>level_period</strong>  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='level_period?-instance_method'>level_period?</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>When set to true all pattern vectors will be converted to use the same
period (the shortest period used in the pattern).</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fast</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>40</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0
</span>
<span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_level_period'>level_period</span> <span class='op'>=</span> <span class='kw'>false</span>  <span class='comment'># Without levelling enabled
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>slow</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    slow   1 0 0 1 0
</span>                                <span class='comment'>#    slow   1 0 0 1 0
</span>
<span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_level_period'>level_period</span> <span class='op'>=</span> <span class='kw'>true</span>   <span class='comment'># With levelling enabled
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>slow</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0</span></code></pre>
    
  </div>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#timing_toggled_pins-instance_method" title="OrigenTesters::Timing#timing_toggled_pins (method)">#timing_toggled_pins</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 27</span>

<span class='kw'>def</span> <span class='id identifier rubyid_level_period'>level_period</span>
  <span class='ivar'>@level_period</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="timing_toggled_pins=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="timing_toggled_pins-instance_method">
  
    #<strong>timing_toggled_pins</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>When period levelling is enabled, vectors will be expanded like this:</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fast</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>40</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0
</span><span class='comment'># Without levelling enabled
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>slow</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    slow   1 0 0 1 0
</span>                                <span class='comment'>#    slow   1 0 0 1 0
</span><span class='comment'># With levelling enabled
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>slow</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0</span></code></pre>

<p>The overall time of the levelled/expanded vectors matches that of the
unlevelled case. i.e. 4 cycles at fast speed (4 * 40ns = 160ns) is
equivalent to 2 cycles at slow speed (2 * 80ns = 160ns).</p>

<p>However, what if pin 1 in the example above was a clk pin where the 1 -&gt;
0 transition was handled by the timing setup for that pin. In that case the
levelled code is no longer functionally correct since it contains 4 clock
pulses while the unlevelled code only has 2.</p>

<p>Such pins can be specified via this attribute and the levelling logic will
then automatically adjust the drive state to keep the number of pulses
correct. It would automatically adjust to the alternative logic state where
0 means &#39;on&#39; and 1 means &#39;off&#39; if applicable.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_timing_toggled_pins'>timing_toggled_pins</span> <span class='op'>&lt;&lt;</span> <span class='gvar'>$dut</span><span class='period'>.</span><span class='id identifier rubyid_pin'>pin</span><span class='lparen'>(</span><span class='symbol'>:tclk</span><span class='rparen'>)</span>  <span class='comment'># This is pin 1
</span>
<span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fast</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>40</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0
</span><span class='comment'># Without levelling enabled
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>slow</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    slow   1 0 0 1 0
</span>                                <span class='comment'>#    slow   1 0 0 1 0
</span><span class='comment'># With levelling enabled
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>slow</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>80</span><span class='rparen'>)</span>
<span class='int'>2</span><span class='period'>.</span><span class='id identifier rubyid_cycles'>cycles</span>                        <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   0 0 0 1 0
</span>                                <span class='comment'>#    fast   1 0 0 1 0
</span>                                <span class='comment'>#    fast   0 0 0 1 0</span></code></pre>

<p>Multiple pins an be specified like this:</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_timing_toggled_pins'>timing_toggled_pins</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='gvar'>$dut</span><span class='period'>.</span><span class='id identifier rubyid_pin'>pin</span><span class='lparen'>(</span><span class='symbol'>:tclk</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='gvar'>$dut</span><span class='period'>.</span><span class='id identifier rubyid_pin'>pin</span><span class='lparen'>(</span><span class='symbol'>:clk</span><span class='rparen'>)</span><span class='rbracket'>]</span>   <span class='comment'># Overrides any pins added elsewhere
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_timing_toggled_pins'>timing_toggled_pins</span> <span class='op'>&lt;&lt;</span> <span class='lbracket'>[</span><span class='gvar'>$dut</span><span class='period'>.</span><span class='id identifier rubyid_pin'>pin</span><span class='lparen'>(</span><span class='symbol'>:tclk</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='gvar'>$dut</span><span class='period'>.</span><span class='id identifier rubyid_pin'>pin</span><span class='lparen'>(</span><span class='symbol'>:clk</span><span class='rparen'>)</span><span class='rbracket'>]</span>  <span class='comment'># In addition to any pins added elsewhere</span></code></pre>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#level_period-instance_method" title="OrigenTesters::Timing#level_period (method)">#level_period</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99
100
101</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 97</span>

<span class='kw'>def</span> <span class='id identifier rubyid_timing_toggled_pins'>timing_toggled_pins</span>
  <span class='ivar'>@timing_toggled_pins</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@timing_toggled_pins</span><span class='period'>.</span><span class='id identifier rubyid_flatten!'>flatten!</span>
  <span class='ivar'>@timing_toggled_pins</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="before_timeset_change-instance_method">
  
    #<strong>before_timeset_change</strong>(options = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 180</span>

<span class='kw'>def</span> <span class='id identifier rubyid_before_timeset_change'>before_timeset_change</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="called_timesets-instance_method">
  
    #<strong>called_timesets</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


268
269
270</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 268</span>

<span class='kw'>def</span> <span class='id identifier rubyid_called_timesets'>called_timesets</span>
  <span class='ivar'>@called_timesets</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="count-instance_method">
  
    #<strong>count</strong>(options = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This function can be used to generate a clock or some other repeating
function that spans accross a range of vectors. The period of each cycle
and the duration of the sequence are supplied via the following options:</p>
<ul><li>
<p>:period_in_cycles</p>
</li><li>
<p>:period_in_ns</p>
</li><li>
<p>:period_in_us</p>
</li><li>
<p>:period_in_ms</p>
</li><li>
<p>:duration_in_cycles</p>
</li><li>
<p>:duration_in_ns</p>
</li><li>
<p>:duration_in_us</p>
</li><li>
<p>:duration_in_ms</p>
</li></ul>

<p>If multiple definitions for either option are supplied then they will be
added together.</p>

<h4 id="label-Example">Example</h4>

<pre class="code ruby"><code class="ruby"><span class='comment'># Supply a clock pulse on :pinA for 100ms
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='symbol'>:period_in_cycles</span> <span class='op'>=&gt;</span> <span class='int'>10</span><span class='comma'>,</span> <span class='symbol'>:duration_in_ms</span> <span class='op'>=&gt;</span> <span class='int'>100</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='gvar'>$top</span><span class='period'>.</span><span class='id identifier rubyid_pin'>pin</span><span class='lparen'>(</span><span class='symbol'>:pinA</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_drive!'>drive!</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
    <span class='gvar'>$top</span><span class='period'>.</span><span class='id identifier rubyid_pin'>pin</span><span class='lparen'>(</span><span class='symbol'>:pinA</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_drive!'>drive!</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 312</span>

<span class='kw'>def</span> <span class='id identifier rubyid_count'>count</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>period_in_cycles:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>period_in_ms:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>period_in_us:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>period_in_ns:</span> <span class='int'>0</span><span class='comma'>,</span>
              <span class='label'>duration_in_cycles:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>duration_in_ms:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>duration_in_us:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='label'>duration_in_ns:</span> <span class='int'>0</span>
            <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_period_cycles'>period_cycles</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:period_in_cycles</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_ms_to_cycles'>ms_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:period_in_ms</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>+</span>
                  <span class='id identifier rubyid_us_to_cycles'>us_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:period_in_us</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_ns_to_cycles'>ns_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:period_in_ns</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_duration_cycles'>duration_cycles</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:duration_in_cycles</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_ms_to_cycles'>ms_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:duration_in_ms</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>+</span>
                    <span class='id identifier rubyid_us_to_cycles'>us_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:duration_in_us</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_ns_to_cycles'>ns_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:duration_in_ns</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_total'>total</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>while</span> <span class='id identifier rubyid_total'>total</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_duration_cycles'>duration_cycles</span>
    <span class='id identifier rubyid_wait'>wait</span><span class='lparen'>(</span><span class='label'>time_in_cycles:</span> <span class='id identifier rubyid_period_cycles'>period_cycles</span><span class='rparen'>)</span>
    <span class='kw'>yield</span>								<span class='comment'># Return control back to caller
</span>    <span class='id identifier rubyid_total'>total</span> <span class='op'>+=</span> <span class='id identifier rubyid_period_cycles'>period_cycles</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="current_period_in_ns-instance_method">
  
    #<strong>current_period_in_ns</strong>  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='current_period-instance_method'>current_period</span>, <span id='period-instance_method'>period</span></span>
    </span>
  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


272
273
274
275
276
277
278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 272</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_period_in_ns'>current_period_in_ns</span>
  <span class='kw'>if</span> <span class='ivar'>@timeset</span>
    <span class='ivar'>@timeset</span><span class='period'>.</span><span class='id identifier rubyid_period_in_ns'>period_in_ns</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>No timeset has been specified yet!</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="current_timeset-instance_method">
  
    #<strong>current_timeset</strong>  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='timeset-instance_method'>timeset</span></span>
    </span>
  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


282
283
284</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 282</span>

<span class='kw'>def</span> <span class='id identifier rubyid_current_timeset'>current_timeset</span>
  <span class='ivar'>@timeset</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cycles_to_time-instance_method">
  
    #<strong>cycles_to_time</strong>(cycles)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Convert the supplied number of cycles to a time, based on the SoC defined
cycle period</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


288
289
290</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 288</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cycles_to_time'>cycles_to_time</span><span class='lparen'>(</span><span class='id identifier rubyid_cycles'>cycles</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='lparen'>(</span><span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>*</span> <span class='id identifier rubyid_current_period_in_ns'>current_period_in_ns</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='int'>1_000_000_000</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delay-instance_method">
  
    #<strong>delay</strong>(cycles, options = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>

<p>This should not be called directly, call via tester#wait</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#wait-instance_method" title="OrigenTesters::Timing#wait (method)">#wait</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


245
246
247
248
249
250
251
252
253
254
255
256
257
258</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 245</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delay'>delay</span><span class='lparen'>(</span><span class='id identifier rubyid_cycles'>cycles</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>/</span> <span class='id identifier rubyid_max_repeat_loop'>max_repeat_loop</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>repeat:</span> <span class='id identifier rubyid_max_repeat_loop'>max_repeat_loop</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_cycle'>cycle</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>repeat:</span> <span class='id identifier rubyid_max_repeat_loop'>max_repeat_loop</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>repeat:</span> <span class='lparen'>(</span><span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>%</span> <span class='id identifier rubyid_max_repeat_loop'>max_repeat_loop</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_cycle'>cycle</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>repeat:</span> <span class='lparen'>(</span><span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>%</span> <span class='id identifier rubyid_max_repeat_loop'>max_repeat_loop</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="max_repeat_loop-instance_method">
  
    #<strong>max_repeat_loop</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


260
261
262</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 260</span>

<span class='kw'>def</span> <span class='id identifier rubyid_max_repeat_loop'>max_repeat_loop</span>
  <span class='ivar'>@max_repeat_loop</span> <span class='op'>||</span> <span class='int'>65_535</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="min_period_timeset-instance_method">
  
    #<strong>min_period_timeset</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the timeset (a Timeset object) with the shortest period that has
been encountered so far in the course of generating the current pattern.</p>

<p>A tester object is re-instantiated at the start of every pattern which will
reset this variable.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_min_period_timeset'>min_period_timeset</span>
  <span class='ivar'>@min_period_timeset</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="min_repeat_loop-instance_method">
  
    #<strong>min_repeat_loop</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


264
265
266</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 264</span>

<span class='kw'>def</span> <span class='id identifier rubyid_min_repeat_loop'>min_repeat_loop</span>
  <span class='ivar'>@min_repeat_loop</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_timeset-instance_method">
  
    #<strong>set_timeset</strong>(timeset, period_in_ns = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set the timeset for the next vectors, this will remain in place until the
next time this is called.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bist_25mhz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>40</span><span class='rparen'>)</span></code></pre>

<p>This method also accepts a block in which case the contained vectors will
generate with the supplied timeset and subsequent vectors will return to
the previous timeset automatically.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bist_25mhz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>40</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_cycle'>cycle</span>
<span class='kw'>end</span></code></pre>

<p>The arguments can also be supplied as a single array, or not at all. In the
latter case the existing timeset will simply be preserved. This is useful
if you have timesets that can be conditionally set based on the target.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Target 1
</span><span class='gvar'>$soc</span><span class='period'>.</span><span class='id identifier rubyid_readout_timeset'>readout_timeset</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>readout</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>120</span><span class='rbracket'>]</span>
<span class='comment'># Target 2
</span><span class='gvar'>$soc</span><span class='period'>.</span><span class='id identifier rubyid_readout_timeset'>readout_timeset</span> <span class='op'>=</span> <span class='kw'>false</span>

<span class='comment'># This code is compatible with both targets, in the first case the timeset will switch
</span><span class='comment'># over, in the second case the existing timeset will be preserved.
</span><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='gvar'>$soc</span><span class='period'>.</span><span class='id identifier rubyid_readout_timeset'>readout_timeset</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_cycle'>cycle</span>
<span class='kw'>end</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 130</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_timeset'>set_timeset</span><span class='lparen'>(</span><span class='id identifier rubyid_timeset'>timeset</span><span class='comma'>,</span> <span class='id identifier rubyid_period_in_ns'>period_in_ns</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_timeset'>timeset</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_timeset'>timeset</span><span class='comma'>,</span> <span class='id identifier rubyid_period_in_ns'>period_in_ns</span> <span class='op'>=</span> <span class='id identifier rubyid_timeset'>timeset</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_timeset'>timeset</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_timeset'>timeset</span> <span class='op'>||=</span> <span class='ivar'>@timeset</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_timeset'>timeset</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Timeset</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You must supply a period_in_ns argument to set_timeset</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_period_in_ns'>period_in_ns</span>
    <span class='id identifier rubyid_timeset'>timeset</span> <span class='op'>=</span> <span class='const'>Timeset</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_timeset'>timeset</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_chomp'>chomp</span><span class='comma'>,</span> <span class='label'>period_in_ns:</span> <span class='id identifier rubyid_period_in_ns'>period_in_ns</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_called_timesets'>called_timesets</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_timeset'>timeset</span> <span class='kw'>unless</span> <span class='id identifier rubyid_called_timesets'>called_timesets</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_timeset'>timeset</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@min_period_timeset</span>
    <span class='ivar'>@min_period_timeset</span> <span class='op'>=</span> <span class='id identifier rubyid_timeset'>timeset</span> <span class='kw'>if</span> <span class='id identifier rubyid_timeset'>timeset</span><span class='period'>.</span><span class='id identifier rubyid_shorter_period_than?'>shorter_period_than?</span><span class='lparen'>(</span><span class='ivar'>@min_period_timeset</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='ivar'>@min_period_timeset</span> <span class='op'>=</span> <span class='id identifier rubyid_timeset'>timeset</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_original'>original</span> <span class='op'>=</span> <span class='ivar'>@timeset</span>
    <span class='id identifier rubyid_timeset_changed'>timeset_changed</span><span class='lparen'>(</span><span class='id identifier rubyid_timeset'>timeset</span><span class='rparen'>)</span>
    <span class='ivar'>@timeset</span> <span class='op'>=</span> <span class='id identifier rubyid_timeset'>timeset</span>
    <span class='kw'>yield</span>
    <span class='id identifier rubyid_timeset_changed'>timeset_changed</span><span class='lparen'>(</span><span class='id identifier rubyid_original'>original</span><span class='rparen'>)</span>
    <span class='ivar'>@timeset</span> <span class='op'>=</span> <span class='id identifier rubyid_original'>original</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_timeset_changed'>timeset_changed</span><span class='lparen'>(</span><span class='id identifier rubyid_timeset'>timeset</span><span class='rparen'>)</span>
    <span class='ivar'>@timeset</span> <span class='op'>=</span> <span class='id identifier rubyid_timeset'>timeset</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="timeset_changed-instance_method">
  
    #<strong>timeset_changed</strong>(timeset)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


167
168
169
170
171
172
173
174
175
176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 167</span>

<span class='kw'>def</span> <span class='id identifier rubyid_timeset_changed'>timeset_changed</span><span class='lparen'>(</span><span class='id identifier rubyid_timeset'>timeset</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_last_vector'>last_vector</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_last_vector'>last_vector</span><span class='period'>.</span><span class='id identifier rubyid_timeset'>timeset</span> <span class='op'>!=</span> <span class='id identifier rubyid_timeset'>timeset</span>
    <span class='id identifier rubyid_change'>change</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>old:</span> <span class='id identifier rubyid_last_vector'>last_vector</span><span class='period'>.</span><span class='id identifier rubyid_timeset'>timeset</span><span class='comma'>,</span> <span class='label'>new:</span> <span class='id identifier rubyid_timeset'>timeset</span> <span class='rbrace'>}</span>
    <span class='comment'># Suppress any duplicate calls
</span>    <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@_last_timeset_change</span> <span class='op'>||</span>
       <span class='lparen'>(</span><span class='ivar'>@_last_timeset_change</span><span class='lbracket'>[</span><span class='symbol'>:new</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id identifier rubyid_change'>change</span><span class='lbracket'>[</span><span class='symbol'>:new</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span>
         <span class='ivar'>@_last_timeset_change</span><span class='lbracket'>[</span><span class='symbol'>:old</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id identifier rubyid_change'>change</span><span class='lbracket'>[</span><span class='symbol'>:old</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_before_timeset_change'>before_timeset_change</span><span class='lparen'>(</span><span class='id identifier rubyid_change'>change</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='ivar'>@_last_timeset_change</span> <span class='op'>=</span> <span class='id identifier rubyid_change'>change</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="wait-instance_method">
  
    #<strong>wait</strong>(options = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Cause the pattern to wait. The following options are available to help you
specify the time to wait:</p>
<ul><li>
<p>:cycles - delays specified in raw cycles, the test model is responsible for
translating this into a sequence of valid repeat statements</p>
</li><li>
<p>:time_in_ns - time specified in nano-seconds</p>
</li><li>
<p>:time_in_us - time specified in micro-seconds</p>
</li><li>
<p>:time_in_ms - time specified in milli-seconds</p>
</li><li>
<p>:time_in_s - time specified in seconds</p>
</li></ul>

<p>If more than one option is supplied they will get added together to give a
final delay time expressed in cycles.</p>

<h4 id="label-Examples">Examples</h4>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_wait'>wait</span><span class='lparen'>(</span><span class='label'>cycles:</span> <span class='int'>100</span><span class='comma'>,</span> <span class='label'>time_in_ns:</span> <span class='int'>200</span><span class='rparen'>)</span>   <span class='comment'># Wait for 100 cycles + 200ns</span></code></pre>

<p>This method can also be used to trigger a match loop in which case the
supplied time becomes the time out for the match. See the J750#match method
for full details of the available options.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$tester</span><span class='period'>.</span><span class='id identifier rubyid_wait'>wait</span><span class='lparen'>(</span><span class='label'>match:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>state:</span> <span class='symbol'>:high</span><span class='comma'>,</span> <span class='label'>pin:</span> <span class='gvar'>$dut</span><span class='period'>.</span><span class='id identifier rubyid_pin'>pin</span><span class='lparen'>(</span><span class='symbol'>:done</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>time_in_ms:</span> <span class='int'>500</span><span class='rparen'>)</span></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/origen_testers/timing.rb', line 198</span>

<span class='kw'>def</span> <span class='id identifier rubyid_wait'>wait</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>cycles:</span>         <span class='int'>0</span><span class='comma'>,</span>
    <span class='label'>time_in_cycles:</span> <span class='int'>0</span><span class='comma'>,</span>
    <span class='label'>time_in_us:</span>     <span class='int'>0</span><span class='comma'>,</span>
    <span class='label'>time_in_ns:</span>     <span class='int'>0</span><span class='comma'>,</span>
    <span class='label'>time_in_ms:</span>     <span class='int'>0</span><span class='comma'>,</span>
    <span class='label'>time_in_s:</span>      <span class='int'>0</span><span class='comma'>,</span>
    <span class='label'>match:</span>          <span class='kw'>false</span><span class='comma'>,</span>   <span class='comment'># Set to true to invoke a match loop where the supplied delay
</span>    <span class='comment'># will become the timeout duration
</span>  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>+=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:cycles</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:time_in_cycles</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>+=</span> <span class='id identifier rubyid_s_to_cycles'>s_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:time_in_s</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>+=</span> <span class='id identifier rubyid_ms_to_cycles'>ms_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:time_in_ms</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>+=</span> <span class='id identifier rubyid_us_to_cycles'>us_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:time_in_us</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>+=</span> <span class='id identifier rubyid_ns_to_cycles'>ns_to_cycles</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:time_in_ns</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_time'>time</span> <span class='op'>=</span> <span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>*</span> <span class='id identifier rubyid_current_period_in_ns'>current_period_in_ns</span>   <span class='comment'># Total delay in ns
</span>  <span class='kw'>case</span>
    <span class='kw'>when</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>&lt;</span> <span class='int'>1000</span>                      <span class='comment'># When less than 1us
</span>      <span class='id identifier rubyid_cc'>cc</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wait for </span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a maximum of </span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:match</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span><span class='embexpr_end'>}</span><span class='tstring_content'>ns</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>when</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>&lt;</span> <span class='int'>1_000_000</span>                   <span class='comment'># When less than 1ms
</span>      <span class='id identifier rubyid_cc'>cc</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wait for </span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a maximum of </span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:match</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_time'>time</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='int'>1000</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>us</span><span class='tstring_end'>&quot;</span></span>        <span class='comment'># Display delay in us
</span>    <span class='kw'>when</span> <span class='id identifier rubyid_time'>time</span> <span class='op'>&lt;</span> <span class='int'>1_000_000_000</span>                <span class='comment'># When less than 1s
</span>      <span class='id identifier rubyid_cc'>cc</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wait for </span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a maximum of </span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:match</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='id identifier rubyid_time'>time</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='int'>1_000_000</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>ms</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_cc'>cc</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wait for </span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>a maximum of </span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:match</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>%.2fs</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lparen'>(</span><span class='id identifier rubyid_time'>time</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='int'>1_000_000_000</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_cycles'>cycles</span> <span class='op'>&gt;</span> <span class='int'>0</span>   <span class='comment'># Allow this function to be called with 0 in which case it will just return
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:match</span><span class='rbracket'>]</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
        <span class='id identifier rubyid_match_block'>match_block</span><span class='lparen'>(</span><span class='id identifier rubyid_cycles'>cycles</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='kw'>yield</span> <span class='rbrace'>}</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:pin</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:state</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_cycles'>cycles</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_delay'>delay</span><span class='lparen'>(</span><span class='id identifier rubyid_cycles'>cycles</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Aug 17 06:58:53 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.1.5).
</div>

    </div>
  </body>
</html>