<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta property="og:locale" content="en_US">
    <meta name="content-language" content="en_US">

    
    <title>Origen - Guides</title>
    <meta property="og:title" content="Origen - Guides">
    <meta name="twitter:title" content="Origen - Guides">
    <meta itemprop="name" content="Origen - Guides">
      
  
  
    <link rel="author" href="https://plus.google.com/u/1/b/106463981272125989995/106463981272125989">
  
  
    <meta property="og:url" content="http://origen-sdk.org/origen/guides/program/flows">
    <meta name="twitter:url" content="http://origen-sdk.org/origen/guides/program/flows">
  
  
    <meta property="og:image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta name="twitter:image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta itemprop="image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta name="twitter:card" content="summary">
  
    <meta property="og:site_name" content="Origen - The Semiconductor Developer's Kit">
  
  
    <meta property="fb:admins" content="origensdk">
  
  
    <meta name="twitter:site" content="@origensdk">
  

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://origen-sdk.org/css/bootstrap_custom.css"></script>
    <!-- Load this up top to allow pages to execute JQuery snippets -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
        ga('create', 'UA-64455560-1', 'auto');
        ga('send', 'pageview');
      </script>
    

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="http://origen-sdk.org/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://origen-sdk.org/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://origen-sdk.org/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://origen-sdk.org/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://origen-sdk.org/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://origen-sdk.org/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://origen-sdk.org/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://origen-sdk.org/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="http://origen-sdk.org/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="http://origen-sdk.org/manifest.json">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
  </head>

  <body>
    
      <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top"><div class="container">
    <div class="navbar-header">
      <a href="/" class="navbar-brand" style="margin-top: -4px;">
        <img src="http://origen-sdk.org/img/origen-device.png" style="height:30px; margin-right: 2px; display: inline; margin-top: -2px;"><img src="http://origen-sdk.org/img/origen-text.png" style="height:15px; display: inline;"></a>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
<li class="dropdown ">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="tour">Tour <span class="caret"></span></a>
          <ul class="dropdown-menu" aria-labelledby="tour">
<li><a href="/origen/tour/basics">Basics</a></li>
            <li class="divider">
            </li>
<li><a href="/origen/tour/test-engineering">Test Engineers</a></li>
            <li><a href="/origen/tour/design-engineering">Design Engineers</a></li>
          </ul>
</li>
        <li class="active"><a href="/origen/guides/starting/introduction">Guides</a></li>
        <li class=""><a href="/origen/videos/1-pattern-in-20-minutes">Videos</a></li>
        <li class=""><a href="/origen/publications">Publications</a></li>
        <li class=""><a href="/origen/api">API</a></li>
        <li class=""><a href="https://github.com/Origen-SDK">Github</a></li>
        <li class=""><a href="/origen/community">Community</a></li>
        <li class=""><a href="/origen/release_notes">Release Notes</a></li>
        <li class=""><a href="/origen/plugins">Plugins</a></li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
</nav><div class="row">
  <div class="col-md-3 sidebar-nav-container">
    <div class="well sidebar-nav" style="margin-top: 20px;">
        <div id="search">
          <form style="margin-bottom: 15px;">
            <div class="input-group">
              <input class="form-control" type="search" placeholder="Search the guides..."><span class="input-group-btn">
                <button type="submit" class="btn btn-search">GO!</button>
              </span>
            </div>
          </form>
        </div>
        <div class="panel-group" id="sidebar-accordion">

          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-0">
              <a class="no-underline">
                Getting Started with Origen
              </a>
            </div>
            <div id="sidebar-collapse-0" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/starting/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/starting/core">Core concepts</a></li>
<li class=""><a href="/origen/guides/starting/installing">How to Install</a></li>
<li class=""><a href="/origen/guides/starting/installwin">How to Install (Windows)</a></li>
<li class=""><a href="/origen/guides/starting/company">Company Customization</a></li>
<li class=""><a href="/origen/guides/starting/gems">Understanding Gems</a></li>
<li class=""><a href="/origen/guides/starting/app">Creating a New App</a></li>
<li class=""><a href="/origen/guides/starting/invoking">Invoking Considerations</a></li>
<li class=""><a href="/origen/guides/starting/commit">The Initial Commit</a></li>
<li class=""><a href="/origen/guides/starting/workspace">Workspace Management</a></li>
<li class=""><a href="/origen/guides/starting/architecture">Application Architecture</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-1">
              <a class="no-underline">
                Runtime Environment
              </a>
            </div>
            <div id="sidebar-collapse-1" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/runtime/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/runtime/mode">Mode</a></li>
<li class=""><a href="/origen/guides/runtime/environment">Environment</a></li>
<li class=""><a href="/origen/guides/runtime/target">Target</a></li>
<li class=""><a href="/origen/guides/runtime/production">Production Targets</a></li>
<li class=""><a href="/origen/guides/runtime/global">Global Setup</a></li>
<li class=""><a href="/origen/guides/runtime/loadorder">Load Order</a></li>
<li class=""><a href="/origen/guides/runtime/programming">Programming</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-2">
              <a class="no-underline">
                Models
              </a>
            </div>
            <div id="sidebar-collapse-2" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/models/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/models/naming">Naming</a></li>
<li class=""><a href="/origen/guides/models/defining">Definition &amp; Hierarchy</a></li>
<li class=""><a href="/origen/guides/models/attributes">Adding Attributes</a></li>
<li class=""><a href="/origen/guides/models/versioning">Versioning</a></li>
<li class=""><a href="/origen/guides/models/bugs">Bugs &amp; Features</a></li>
<li class=""><a href="/origen/guides/models/modes">Package, Mode &amp; Configuration</a></li>
<li class=""><a href="/origen/guides/models/registers">Registers</a></li>
<li class=""><a href="/origen/guides/models/pins">Pins</a></li>
<li class=""><a href="/origen/guides/models/power">Power Domains</a></li>
<li class=""><a href="/origen/guides/models/hw">Hardware Attributes</a></li>
<li class=""><a href="/origen/guides/models/parameters">Parameters</a></li>
<li class=""><a href="/origen/guides/models/specs">Specifications</a></li>
<li class=""><a href="/origen/guides/models/fuses">Fuses</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-3">
              <a class="no-underline">
                Compiler (Views)
              </a>
            </div>
            <div id="sidebar-collapse-3" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/compiler/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/compiler/creating">Creating Templates</a></li>
<li class=""><a href="/origen/guides/compiler/subtemplates">Using Sub-Templates</a></li>
<li class=""><a href="/origen/guides/compiler/helpers">Helpers</a></li>
<li class=""><a href="/origen/guides/compiler/running">Running The Compiler</a></li>
<li class=""><a href="/origen/guides/compiler/inline">Inline Compiler</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-4">
              <a class="no-underline">
                Controllers
              </a>
            </div>
            <div id="sidebar-collapse-4" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/controllers/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/controllers/shadow">Shadow Controllers</a></li>
<li class=""><a href="/origen/guides/controllers/direct">Direct Controllers</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-5">
              <a class="no-underline">
                Pattern Generator
              </a>
            </div>
            <div id="sidebar-collapse-5" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/pattern/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/pattern/creating">Creating Patterns</a></li>
<li class=""><a href="/origen/guides/pattern/pins">Pins</a></li>
<li class=""><a href="/origen/guides/pattern/timing">Timing and Waiting</a></li>
<li class=""><a href="/origen/guides/pattern/registers">Registers</a></li>
<li class=""><a href="/origen/guides/pattern/documenting">Documenting Patterns</a></li>
<li class=""><a href="/origen/guides/pattern/name">Generating by Name</a></li>
<li class=""><a href="/origen/guides/pattern/common">Common API</a></li>
<li class=""><a href="/origen/guides/pattern/j750">J750 API</a></li>
<li class=""><a href="/origen/guides/pattern/v93k">V93K API</a></li>
<li class=""><a href="/origen/guides/pattern/ultraflex">UltraFlex API</a></li>
<li class=""><a href="/origen/guides/pattern/custom">Custom Testers</a></li>
<li class=""><a href="/origen/guides/pattern/running">Running The PatGen</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-6">
              <a class="no-underline">
                Test Program Generator
              </a>
            </div>
            <div id="sidebar-collapse-6" class="panel-collapse collapse in">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/program/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/program/philosophy">Philosophy</a></li>
<li class="active"><a href="/origen/guides/program/flows">Creating Flows</a></li>
<li class=""><a href="/origen/guides/program/flowapi">Managing Flow Control</a></li>
<li class=""><a href="/origen/guides/program/interface">Creating an Interface</a></li>
<li class=""><a href="/origen/guides/program/resources">Additional Resources</a></li>
<li class=""><a href="/origen/guides/program/code">Dynamic Custom Code</a></li>
<li class=""><a href="/origen/guides/program/j750">J750 API</a></li>
<li class=""><a href="/origen/guides/program/v93k">V93K API</a></li>
<li class=""><a href="/origen/guides/program/ultraflex">UltraFLEX API</a></li>
<li class=""><a href="/origen/guides/program/doc">Documenting the Program</a></li>
<li class=""><a href="/origen/guides/program/custom">Creating Custom Testers</a></li>
<li class=""><a href="/origen/guides/program/generating">Running the ProgGen</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-7">
              <a class="no-underline">
                Documentation Generator
              </a>
            </div>
            <div id="sidebar-collapse-7" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/documentation/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/documentation/markdown">Markdown</a></li>
<li class=""><a href="/origen/guides/documentation/linking">Linking</a></li>
<li class=""><a href="/origen/guides/documentation/styling">Styling</a></li>
<li class=""><a href="/origen/guides/documentation/testing">Testing</a></li>
<li class=""><a href="/origen/guides/documentation/api">API Generation</a></li>
<li class=""><a href="/origen/guides/documentation/deploying">Deploying</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-8">
              <a class="no-underline">
                Plugins
              </a>
            </div>
            <div id="sidebar-collapse-8" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/plugins/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/plugins/importing">Using a Plugin</a></li>
<li class=""><a href="/origen/guides/plugins/creating">Creating a Plugin</a></li>
<li class=""><a href="/origen/guides/plugins/current">Current Plugin</a></li>
<li class=""><a href="/origen/guides/plugins/environment">Dev Environment</a></li>
<li class=""><a href="/origen/guides/plugins/development">Dev Considerations</a></li>
<li class=""><a href="/origen/guides/plugins/paths">Paths &amp; Origen.root</a></li>
<li class=""><a href="/origen/guides/plugins/app">Config &amp; Origen.app</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-9">
              <a class="no-underline">
                Miscellaneous
              </a>
            </div>
            <div id="sidebar-collapse-9" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/misc/revisioncontrol">Revision Control</a></li>
<li class=""><a href="/origen/guides/misc/remotes">Origen Remotes</a></li>
<li class=""><a href="/origen/guides/misc/lint">Lint Testing</a></li>
<li class=""><a href="/origen/guides/misc/session">Session Store</a></li>
<li class=""><a href="/origen/guides/misc/lsf">LSF API</a></li>
<li class=""><a href="/origen/guides/misc/users">Users, Emails &amp; Maillists</a></li>
<li class=""><a href="/origen/guides/misc/coreext">Ruby Extensions</a></li>
<li class=""><a href="/origen/guides/misc/logger">Logger</a></li>
<li class=""><a href="/origen/guides/misc/commands">Adding Commands</a></li>
<li class=""><a href="/origen/guides/misc/commandsov">Overriding Commands</a></li>
<li class=""><a href="/origen/guides/misc/callbacks">Callbacks</a></li>
<li class=""><a href="/origen/guides/misc/appcallbacks">Application Callbacks</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-10">
              <a class="no-underline">
                Advanced Topics
              </a>
            </div>
            <div id="sidebar-collapse-10" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/advanced/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/advanced/invocations">Invocation Customization</a></li>
<li class=""><a href="/origen/guides/advanced/newapps">Custom App Generators</a></li>
                </ul>
</div>
            </div>
          </div>
      

        </div>

    </div>
  </div>

  <div class="col-md-9 nav-page-container">
    <article class="search-results"><h3 class="topic-title">Test Program Generator</h3>

      <h2 class="topic-subtitle">Creating Flows</h2>

      <hr>
<p>The test flow is where you describe everything about what your test program
must do:</p>

      <ul>
<li>The tests it must run</li>
        <li>The conditions applied by these tests</li>
        <li>Test limits</li>
        <li>Bin and test numbers</li>
        <li>Conditional test execution and other flow control</li>
        <li>Notes about the reason for running or the methodology behind each test</li>
      </ul>
<p>When writing your flow file you should try and distill down the amount of information
to the bare minimum, the goal here is to write as little as possible yet still
capture the details about what makes each test unique.</p>

      <p>When describing each test the syntax and naming conventions are entirely
up to you and based on your knowledge about the application domain and the
type and variety of tests that you need to generate.
It will be the job of the interface (which you will write later) to translate
this description into method calls to the generation API for the target platform.</p>

      <div>    
  <a class="anchor" name="Your_First_Flow_File"></a>          
  <h4><a href="#Your_First_Flow_File">Your First Flow File</a></h4>          
</div>

      <p>By convention all flow files should reside in the “program” directory within
the application top-level directory.</p>

      <p>Create the file “program/probe.rb” as shown below:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/probe.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create <span style="color:#080;font-weight:bold">do</span>

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>The above represents all of the officially required syntax to define a flow, what
goes inside is now completely down to the needs of the application.</p>

      <p>When creating a flow like this it is often useful to supply some context about
the environment in which it will run. For example we have indicated via the name that this
is a flow intended to run at probe, we can also note this in the code:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/probe.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create(<span style="color:#606">environment</span>: <span style="color:#A60">:probe</span>) <span style="color:#080;font-weight:bold">do</span>

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>Again the naming of the terms <code>:environment</code> and <code>:probe</code> are
completely arbitrary, you may want to note some details about the temperature, parallelism
or other details which may be useful to you when it comes to actually generating
the flow for a given ATE platform.
Or not. Don’t worry about this too much right now, in practice it is probably best to
just add things like this as you find that you need them. The main thing for now is just to
appreciate that you can pass some details about the execution environment of the given
flow to the interface via this mechanism.</p>

      <div>    
  <a class="anchor" name="Specifying_Numbers"></a>          
  <h4><a href="#Specifying_Numbers">Specifying Numbers</a></h4>          
</div>

      <p>Origen extends Ruby to add the following methods which are very helpful
when specifying test conditions:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#00D">3</span>.A     <span style="color:#777"># =&gt; 3 </span>
<span style="color:#00D">3</span>.mA    <span style="color:#777"># =&gt; 0.003 </span>
<span style="color:#00D">3</span>.uA    <span style="color:#777"># =&gt; 0.000003 </span>
<span style="color:#00D">3</span>.nA    <span style="color:#777"># =&gt; 0.000000003 </span>
<span style="color:#00D">3</span>.pA    <span style="color:#777"># =&gt; 0.000000000003 </span>

<span style="color:#00D">3</span>.V     <span style="color:#777"># =&gt; 3</span>
<span style="color:#00D">3</span>.mV    <span style="color:#777"># =&gt; 0.003</span>
        <span style="color:#777"># =&gt; etc</span>

<span style="color:#00D">3</span>.Hz    <span style="color:#777"># =&gt; 3        </span>
<span style="color:#00D">3</span>.kHz   <span style="color:#777"># =&gt; 3000        </span>
<span style="color:#00D">3</span>.MHz   <span style="color:#777"># =&gt; 3000000</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Adding_Some_Tests"></a>          
  <h4><a href="#Adding_Some_Tests">Adding Some Tests</a></h4>          
</div>

      <p>So let’s say we are writing a test for a voltage regulator module, we have a functional
test and then two parametric tests that we wish to run - one that simply tests the
output and one that tests the output under load.
Let’s start with this:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/probe.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create(<span style="color:#606">environment</span>: <span style="color:#A60">:probe</span>) <span style="color:#080;font-weight:bold">do</span>

  log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Vreg test module</span><span style="color:#710">"</span></span>

  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">pattern</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">vreg/functional</span><span style="color:#710">"</span></span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">bin</span>: <span style="color:#00D">5</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>, <span style="color:#606">tnum</span>: <span style="color:#00D">101000</span>

  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">pattern</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">vreg/functional</span><span style="color:#710">"</span></span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">bin</span>: <span style="color:#00D">5</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>, <span style="color:#606">tnum</span>: <span style="color:#00D">101001</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">pattern</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">vreg/meas</span><span style="color:#710">"</span></span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">bin</span>: <span style="color:#00D">5</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">tnum</span>: <span style="color:#00D">105000</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">pattern</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">vreg/meas</span><span style="color:#710">"</span></span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">bin</span>: <span style="color:#00D">5</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">tnum</span>: <span style="color:#00D">105001</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">pattern</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">vreg/meas</span><span style="color:#710">"</span></span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">bin</span>: <span style="color:#00D">5</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">tnum</span>: <span style="color:#00D">105002</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.10</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">pattern</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">vreg/meas</span><span style="color:#710">"</span></span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">bin</span>: <span style="color:#00D">5</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">tnum</span>: <span style="color:#00D">105003</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>This is a good start, we have something that resembles a test flow and we have gone with the
general convention that a flow line is structured like this:</p>

      <div class="language-text highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>&lt;function&gt; &lt;name&gt;, &lt;attributes&gt;
</pre></div>
</div>
      </div>

      <ul>
<li>
<strong>function</strong> - The main function of a particular test, here we have gone with the categories
‘log’, ‘func(tional)’ and ‘para(metric)’. You may wish to have other categories based on your domain.
For example in some NVM applications we have ‘program’, ‘read’, ‘erase’, ‘measure’, ‘bitmap’,
and so on. Each of these functions correspond to the methods that you will need to implement
in your interface later.</li>
        <li>
<strong>name</strong> - Almost every test will need a name and so we make this a mandatory argument.</li>
        <li>
<strong>attributes</strong> - There then follows a free-format list of attributes, use these to describe
the test and especially including anything that makes the test unique, such as the load
attribute which has been used above.</li>
      </ul>
<p>As mentioned previously this choice of convention is just that, a personal choice, however
this is the convention that is currently used in the flagship Origen applications that are
currently driving the development of the framework.
As the Origen program generator matures and the number of applications using it grows, it is
possible that alternative and better conventions will begin to emerge.
If you come across a better approach then please come and tell us about via the
<a href="/origen/community">Origen community channels</a>,
however we will stick with this one for now.</p>

      <div>    
  <a class="anchor" name="Eliminate_Anything_that_can_be_Inferred"></a>          
  <h4><a href="#Eliminate_Anything_that_can_be_Inferred">Eliminate Anything that can be Inferred</a></h4>          
</div>

      <p>Remember that the goal here is to be as concise as possible, since the more concise you
are at this level then the more you can automate later. This eliminates duplication and
redundancy, reduces the amount of code you need to write to add a new test later, and the
more that can be generated the less chance there is for human error.</p>

      <p>There are a few opportunities for simplification that we can consider at this point:</p>

      <ul>
<li>The <strong>pattern</strong> field seems redundant - it very closely mirrors what has been assigned to the
test name, therefore we can infer the pattern name without explicitly declaring it. It is generally
a good approach to name the test after the pattern if you normally have one pattern per test.</li>
        <li>The <strong>bin</strong> number also looks to be redundant, it is always 5. In a case like this what
we can do is set a default of 5 within the interface, then if it is not declared for a specific
test it will be 5, but we can always override it for a specific test.</li>
        <li>The <strong>tnum</strong> attribute seems to follow the general rule that it is the softbin number * 1000
and then a counter. Anything that is the result of a function based on other
attributes is ripe for elimination.</li>
      </ul>
<p>With those optimizations applied we end up with:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/probe.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create(<span style="color:#606">environment</span>: <span style="color:#A60">:probe</span>) <span style="color:#080;font-weight:bold">do</span>

  log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Vreg test module</span><span style="color:#710">"</span></span>

  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>

  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.10</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>Finally we seem to always be running our tests at min vdd and then max vdd, so again
there seems to be a convention that we could choose to implement by default. One issue we
have is that the loaded test has a different limit between min and max, so this a
good example of one case where we would override the default.</p>

      <p>So switching to the convention that each test will execute at min and max vdd unless otherwise
specified, our final flow is:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/probe.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create(<span style="color:#606">environment</span>: <span style="color:#A60">:probe</span>) <span style="color:#080;font-weight:bold">do</span>

  log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Vreg test module</span><span style="color:#710">"</span></span>

  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span><span style="color:#036;font-weight:bold">V</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.10</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>That very clearly and concisely describes what the flow must do. Also by establishing
conventions and eliminating redundancy we have made it really easy for us to add
a new test in the future.</p>

      <div>    
  <a class="anchor" name="Flow_Control"></a>          
  <h4><a href="#Flow_Control">Flow Control</a></h4>          
</div>

      <p>See the next section for details on run-time flow control.</p>

      <p>For build-time flow control you have complete access to the current target objects if you
need to conditionally build some tests.</p>

      <p>Lets say we have two DUT designs, and one of them has a bug which means that the
vreg load test will not work properly. Let’s say its a problem with the pad connection
such that the vreg works ok but it just can’t be tested via an external load.
Our models to represent this situation would look something like this:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># lib/dut_1.rb</span>
<span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DUT1</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">Model</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#777"># lib/dut_2.rb</span>
<span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DUT2</span> &lt; <span style="color:#036;font-weight:bold">DUT</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">Model</span>

  bug <span style="color:#A60">:vreg_pad</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#036;font-weight:bold">DUT1</span>.new.has_bug?(<span style="color:#A60">:vreg_pad</span>)  <span style="color:#777"># =&gt; false</span>
<span style="color:#036;font-weight:bold">DUT2</span>.new.has_bug?(<span style="color:#A60">:vreg_pad</span>)  <span style="color:#777"># =&gt; true</span>
</pre></div>
</div>
      </div>

      <p>There are two ways that we could build the flow to ensure that DUT2 can still give a bin 1 - either
skip the loaded test completely, or else don’t care its result.
Here is an example of both:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/probe.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create(<span style="color:#606">environment</span>: <span style="color:#A60">:probe</span>) <span style="color:#080;font-weight:bold">do</span>

  log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Vreg test module</span><span style="color:#710">"</span></span>

  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  <span style="color:#777"># Don't build this test if the target DUT has the bug</span>
  <span style="color:#080;font-weight:bold">unless</span> <span style="color:#d70">$dut</span>.has_bug?(<span style="color:#A60">:vreg_pad</span>)
    para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.10</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>
  <span style="color:#080;font-weight:bold">end</span>

  <span style="color:#777"># Continue on fail if the target DUT has the bug</span>
  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>, <span style="color:#606">continue</span>: <span style="color:#d70">$dut</span>.has_bug?(<span style="color:#A60">:vreg_pad</span>)

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Re-usable_Flow_Snippets"></a>          
  <h4><a href="#Re-usable_Flow_Snippets">Re-usable Flow Snippets</a></h4>          
</div>

      <p>It is ofter useful to extract sections of a flow into a sub-module, so that it can be re-used
and parameterized.
In our case let’s say that we have a new DUT on the horizon which has two vreg instances, so
let’s extract this suite of vreg tests to a module so that we can instantiate two of them in
our flow.</p>

      <p>All sub flow file names must begin with “_”, this is what tells Origen that it is a sub-flow and
not a top-level flow.
The sub-flow syntax is virtually identical to the regular flow syntax except that a hash of
options are passed in which will contain any arguments passed in by the caller when they
instantiate the sub-flow.</p>

      <p>Let’s convert our flow to a sub-flow in file “_vreg.rb”:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/_vreg.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create <span style="color:#080;font-weight:bold">do</span> |options|

  log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Vreg test module</span><span style="color:#710">"</span></span>

  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>

  <span style="color:#777"># Don't build this test if the target DUT has the bug</span>
  <span style="color:#080;font-weight:bold">unless</span> <span style="color:#d70">$dut</span>.has_bug?(<span style="color:#A60">:vreg_pad</span>)
    para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.10</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>
  <span style="color:#080;font-weight:bold">end</span>

  <span style="color:#777"># Continue on fail if the target DUT has the bug</span>
  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>, <span style="color:#606">continue</span>: <span style="color:#d70">$dut</span>.has_bug?(<span style="color:#A60">:vreg_pad</span>)

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>Not much has changed so far - the environment option has been removed from the <code>Flow.create</code>
definition since that is more of a top-level concern, and the options have been added.</p>

      <p>There are a couple of opportunities for improvement here:</p>

      <ul>
<li>The flow allows the loaded tests to be skipped, however it would be better if the sub-flow
did not define the conditions under which they should be skipped - that decision should be
made by to the top-level.</li>
        <li>If this test is going to be instantiated multiple times it will need some kind of index
to target the test at vreg 0 or vreg 1.</li>
      </ul>
<p>Here is the flow with these modifications:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/_vreg.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create <span style="color:#080;font-weight:bold">do</span> |options|

  <span style="color:#777"># These are the option defaults that will be used unless specified by the caller</span>
  options = {
    <span style="color:#606">include_loaded_output_tests</span>: <span style="color:#069">true</span>,
    <span style="color:#606">index</span>: <span style="color:#00D">0</span>,
  }.merge(options)

  log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Vreg test module</span><span style="color:#710">"</span></span>

  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>, <span style="color:#606">index</span>: options[<span style="color:#A60">:index</span>]

  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>, <span style="color:#606">index</span>: options[<span style="color:#A60">:index</span>]

  <span style="color:#080;font-weight:bold">if</span> options[<span style="color:#A60">:include_loaded_output_tests</span>]

    para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.10</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>, <span style="color:#606">index</span>: options[<span style="color:#A60">:index</span>]

    para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>, <span style="color:#606">index</span>: options[<span style="color:#A60">:index</span>]

  <span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>For now we have not really committed to how the indexed tests will be generated, but we have
passed the information along to the interface. Most likely when it comes to generating the
pattern name within the interface we will just append the index to the name.</p>

      <p>So the original top-level flow is now really simple:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/probe.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create(<span style="color:#606">environment</span>: <span style="color:#A60">:probe</span>) <span style="color:#080;font-weight:bold">do</span>

  import <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">vreg</span><span style="color:#710">"</span></span>, <span style="color:#606">include_loaded_output_tests</span>: !<span style="color:#d70">$dut</span>.has_bug?(<span style="color:#A60">:vreg_pad</span>)

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>The path argument supplied to the import method can be either a relative path from the
current file (as it is above), for example <code>"../components/vreg"</code>, or an
absolute path such as <code>"#{Origen.root}/program/components/vreg"</code>. In both cases
the underscore prefix is not required.</p>

      <p>The original reason for doing this was to add support for testing multiple
vreg instances. To support such a case let’s say that our DUT model will implement a
method called <code>vregs</code> which will return one or more vreg models wrapped
in an array.</p>

      <p>Our final flow is:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/probe.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create(<span style="color:#606">environment</span>: <span style="color:#A60">:probe</span>) <span style="color:#080;font-weight:bold">do</span>

  <span style="color:#d70">$dut</span>.vregs.each_with_index <span style="color:#080;font-weight:bold">do</span> |vreg, i|

    import <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">vreg</span><span style="color:#710">"</span></span>, <span style="color:#606">include_loaded_output_tests</span>: !<span style="color:#d70">$dut</span>.has_bug?(<span style="color:#A60">:vreg_pad</span>), <span style="color:#606">index</span>: i

  <span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Documenting_Tests"></a>          
  <h4><a href="#Documenting_Tests">Documenting Tests</a></h4>          
</div>

      <p>All of the test attributes will be available later when it comes to generating documentation
of the test program, so there is no need to document them manually.
However in some cases it will also be useful to include some
text describing perhaps how the test works, or why it is being done.
Such information can be added via regular Ruby comments immediately before the given
test.</p>

      <p>Origen will extract these later when it comes to generating documentation.</p>

      <p>The comments will be parsed as <a href="http://kramdown.rubyforge.org/quickref.html">Markdown</a>
so this can be used to make things like bulleted lists or tables.</p>

      <p>Here is our vreg test suite with some example documentation added:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># program/_vreg.rb</span>
<span style="color:#036;font-weight:bold">Flow</span>.create <span style="color:#080;font-weight:bold">do</span> |options|

  <span style="color:#777"># These are the option defaults that will be used unless specified by the caller</span>
  options = {
    <span style="color:#606">include_loaded_output_tests</span>: <span style="color:#069">true</span>,
    <span style="color:#606">index</span>: <span style="color:#00D">0</span>,
  }.merge(options)

  log <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Vreg test module</span><span style="color:#710">"</span></span>

  <span style="color:#777"># This test verifies that the following things work:</span>
  <span style="color:#777">#</span>
  <span style="color:#777"># * The vreg can be disabled</span>
  <span style="color:#777"># * The trim register can be written to and read from</span>
  func <span style="color:#A60">:vreg_functional</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">101</span>, <span style="color:#606">index</span>: options[<span style="color:#A60">:index</span>]

  <span style="color:#777"># Measure the output of the vreg under no load, this is a simple</span>
  <span style="color:#777"># test to catch any gross defects that prevent the vreg from working</span>
  para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>, <span style="color:#606">index</span>: options[<span style="color:#A60">:index</span>]

  <span style="color:#080;font-weight:bold">if</span> options[<span style="color:#A60">:include_loaded_output_tests</span>]

    <span style="color:#777"># Measure the output of the vreg under the given load, this is approximately</span>
    <span style="color:#777"># equivalent to 1.5x the maximum load anticipated in a customer application.</span>
    para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:min</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.10</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>, <span style="color:#606">index</span>: options[<span style="color:#A60">:index</span>]

    <span style="color:#777"># As above</span>
    para <span style="color:#A60">:vreg_meas</span>, <span style="color:#606">vdd</span>: <span style="color:#A60">:max</span>, <span style="color:#606">softbin</span>: <span style="color:#00D">105</span>, <span style="color:#606">load</span>: <span style="color:#00D">5</span>.mA, <span style="color:#606">lo</span>: <span style="color:#60E">1.12</span>, <span style="color:#606">hi</span>: <span style="color:#60E">1.34</span>, <span style="color:#606">index</span>: options[<span style="color:#A60">:index</span>]

  <span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div style="position: relative">
  <hr>
<div>    
  <a class="anchor" name="Comments"></a>          
  <h4><a href="#Comments">Comments</a></h4>          
</div>
</div>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'origen-sdk';
    var disqus_title;
    var disqus_url = 'http://' + window.location.hostname + window.location.pathname;

    disqus_title = $("h1").text();
    if (disqus_title.length == 0) {
      disqus_title = $("h2").text();
    }
    if (disqus_title.length == 0) {
      disqus_title = $("h3").text();
    }
    if (disqus_title.length == 0) {
      disqus_title = $("title").text();
    } else {
      disqus_title = disqus_title + ' (' + $("title").text() + ')';
    }

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>

    </article>
</div>
</div>

<script src="/origen/search.js"></script>
      </div><!-- /.container -->
    

    <footer class="footer">
      <div class="container">
        <p class="pull-left text-muted">
          Generated with the <a href="http://origen-sdk.org">Origen Semiconductor Developer's Kit</a>
        </p>
        <p class="pull-right text-muted">Origen is released under the terms of the <a href="https://choosealicense.com/licenses/mit/">MIT license</a></p>
      </div>
    </footer>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="http://origen-sdk.org/js/lunr.min.js"></script>
    <script src="http://origen-sdk.org/js/highlight.js"></script>
    <script src="http://origen-sdk.org/js/custom.js"></script>
    
      <script>
        ((window.gitter = {}).chat = {}).options = {
          room: 'Origen-SDK/users'
        };
      </script>
      <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
    
  </body>
</html>
