<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta property="og:locale" content="en_US">
    <meta name="content-language" content="en_US">

    
    <title>Origen - Guides</title>
    <meta property="og:title" content="Origen - Guides">
    <meta name="twitter:title" content="Origen - Guides">
    <meta itemprop="name" content="Origen - Guides">
      
  
  
    <link rel="author" href="https://plus.google.com/u/1/b/106463981272125989995/106463981272125989">
  
  
    <meta property="og:url" content="http://origen-sdk.org/origen/guides/models/registers">
    <meta name="twitter:url" content="http://origen-sdk.org/origen/guides/models/registers">
  
  
    <meta property="og:image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta name="twitter:image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta itemprop="image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta name="twitter:card" content="summary">
  
    <meta property="og:site_name" content="Origen - The Semiconductor Developer's Kit">
  
  
    <meta property="fb:admins" content="origensdk">
  
  
    <meta name="twitter:site" content="@origensdk">
  

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://origen-sdk.org/css/bootstrap_custom.css"></script>
    <!-- Load this up top to allow pages to execute JQuery snippets -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
        ga('create', 'UA-64455560-1', 'auto');
        ga('send', 'pageview');
      </script>
    

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="http://origen-sdk.org/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://origen-sdk.org/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://origen-sdk.org/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://origen-sdk.org/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://origen-sdk.org/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://origen-sdk.org/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://origen-sdk.org/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://origen-sdk.org/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="http://origen-sdk.org/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="http://origen-sdk.org/manifest.json">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
  </head>

  <body>
    
      <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <a href="/" class="navbar-brand" style="margin-top: -4px;">
        <img src="http://origen-sdk.org/img/origen-device.png" style="height:30px; margin-right: 2px; display: inline; margin-top: -2px;">
        <img src="http://origen-sdk.org/img/origen-text.png" style="height:15px; display: inline;">
      </a>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown ">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="tour">Tour <span class="caret"></span></a>
          <ul class="dropdown-menu" aria-labelledby="tour">
            <li><a href="/origen/tour/basics">Basics</a></li>
            <li class="divider">
            </li>
<li><a href="/origen/tour/test-engineering">Test Engineers</a></li>
            <li><a href="/origen/tour/design-engineering">Design Engineers</a></li>
          </ul>
        </li>
        <li class="active"><a href="/origen/guides/starting/introduction">Guides</a></li>
        <li class=""><a href="/origen/videos/1-pattern-in-20-minutes">Videos</a></li>
        <li class=""><a href="/origen/publications">Publications</a></li>
        <li class=""><a href="/origen/api">API</a></li>
        <li class=""><a href="https://github.com/Origen-SDK">Github</a></li>
        <li class=""><a href="/origen/community">Community</a></li>
        <li class=""><a href="/origen/release_notes">Release Notes</a></li>
        <li class=""><a href="/origen/plugins">Plugins</a></li>
      </ul>
    </div>
<!--/.nav-collapse -->
  </div>
</nav>

<div class="row">
  <div class="col-md-3 sidebar-nav-container">
    <div class="well sidebar-nav" style="margin-top: 20px;">
        <div id="search">
          <form style="margin-bottom: 15px;">
            <div class="input-group">
              <input class="form-control" type="search" placeholder="Search the guides...">
              <span class="input-group-btn">
                <button type="submit" class="btn btn-search">GO!</button>
              </span>
            </div>
          </form>
        </div>
        <div class="panel-group" id="sidebar-accordion">

          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-0">
              <a class="no-underline">
                Getting Started with Origen
              </a>
            </div>
            <div id="sidebar-collapse-0" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/starting/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/starting/core">Core concepts</a></li>
<li class=""><a href="/origen/guides/starting/installing">How to Install</a></li>
<li class=""><a href="/origen/guides/starting/installwin">How to Install (Windows)</a></li>
<li class=""><a href="/origen/guides/starting/company">Company Customization</a></li>
<li class=""><a href="/origen/guides/starting/gems">Understanding Gems</a></li>
<li class=""><a href="/origen/guides/starting/app">Creating a New App</a></li>
<li class=""><a href="/origen/guides/starting/invoking">Invoking Considerations</a></li>
<li class=""><a href="/origen/guides/starting/commit">The Initial Commit</a></li>
<li class=""><a href="/origen/guides/starting/workspace">Workspace Management</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-1">
              <a class="no-underline">
                Runtime Environment
              </a>
            </div>
            <div id="sidebar-collapse-1" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/runtime/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/runtime/mode">Mode</a></li>
<li class=""><a href="/origen/guides/runtime/environment">Environment</a></li>
<li class=""><a href="/origen/guides/runtime/target">Target</a></li>
<li class=""><a href="/origen/guides/runtime/production">Production Targets</a></li>
<li class=""><a href="/origen/guides/runtime/global">Global Setup</a></li>
<li class=""><a href="/origen/guides/runtime/loadorder">Load Order</a></li>
<li class=""><a href="/origen/guides/runtime/programming">Programming</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-2">
              <a class="no-underline">
                Models
              </a>
            </div>
            <div id="sidebar-collapse-2" class="panel-collapse collapse in">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/models/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/models/naming">Naming</a></li>
<li class=""><a href="/origen/guides/models/defining">Definition &amp; Hierarchy</a></li>
<li class=""><a href="/origen/guides/models/attributes">Adding Attributes</a></li>
<li class=""><a href="/origen/guides/models/versioning">Versioning</a></li>
<li class=""><a href="/origen/guides/models/bugs">Bugs &amp; Features</a></li>
<li class=""><a href="/origen/guides/models/modes">Package, Mode &amp; Configuration</a></li>
<li class="active"><a href="/origen/guides/models/registers">Registers</a></li>
<li class=""><a href="/origen/guides/models/pins">Pins</a></li>
<li class=""><a href="/origen/guides/models/hw">Hardware Attributes</a></li>
<li class=""><a href="/origen/guides/models/parameters">Parameters</a></li>
<li class=""><a href="/origen/guides/models/specs">Specifications</a></li>
<li class=""><a href="/origen/guides/models/fuses">Fuses</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-3">
              <a class="no-underline">
                Compiler (Views)
              </a>
            </div>
            <div id="sidebar-collapse-3" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/compiler/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/compiler/creating">Creating Templates</a></li>
<li class=""><a href="/origen/guides/compiler/subtemplates">Using Sub-Templates</a></li>
<li class=""><a href="/origen/guides/compiler/helpers">Helpers</a></li>
<li class=""><a href="/origen/guides/compiler/running">Running The Compiler</a></li>
<li class=""><a href="/origen/guides/compiler/inline">Inline Compiler</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-4">
              <a class="no-underline">
                Controllers
              </a>
            </div>
            <div id="sidebar-collapse-4" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/controllers/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/controllers/shadow">Shadow Controllers</a></li>
<li class=""><a href="/origen/guides/controllers/direct">Direct Controllers</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-5">
              <a class="no-underline">
                Pattern Generator
              </a>
            </div>
            <div id="sidebar-collapse-5" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/pattern/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/pattern/creating">Creating Patterns</a></li>
<li class=""><a href="/origen/guides/pattern/pins">Pins</a></li>
<li class=""><a href="/origen/guides/pattern/timing">Timing and Waiting</a></li>
<li class=""><a href="/origen/guides/pattern/registers">Registers</a></li>
<li class=""><a href="/origen/guides/pattern/documenting">Documenting Patterns</a></li>
<li class=""><a href="/origen/guides/pattern/name">Generating by Name</a></li>
<li class=""><a href="/origen/guides/pattern/common">Common API</a></li>
<li class=""><a href="/origen/guides/pattern/j750">J750 API</a></li>
<li class=""><a href="/origen/guides/pattern/v93k">V93K API</a></li>
<li class=""><a href="/origen/guides/pattern/ultraflex">UltraFlex API</a></li>
<li class=""><a href="/origen/guides/pattern/custom">Custom Testers</a></li>
<li class=""><a href="/origen/guides/pattern/running">Running The PatGen</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-6">
              <a class="no-underline">
                Test Program Generator
              </a>
            </div>
            <div id="sidebar-collapse-6" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/program/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/program/philosophy">Philosophy</a></li>
<li class=""><a href="/origen/guides/program/flows">Creating Flows</a></li>
<li class=""><a href="/origen/guides/program/flowapi">Managing Flow Control</a></li>
<li class=""><a href="/origen/guides/program/interface">Creating an Interface</a></li>
<li class=""><a href="/origen/guides/program/resources">Additional Resources</a></li>
<li class=""><a href="/origen/guides/program/code">Dynamic Custom Code</a></li>
<li class=""><a href="/origen/guides/program/j750">J750 API</a></li>
<li class=""><a href="/origen/guides/program/v93k">V93K API</a></li>
<li class=""><a href="/origen/guides/program/ultraflex">UltraFLEX API</a></li>
<li class=""><a href="/origen/guides/program/doc">Documenting the Program</a></li>
<li class=""><a href="/origen/guides/program/custom">Creating Custom Testers</a></li>
<li class=""><a href="/origen/guides/program/generating">Running the ProgGen</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-7">
              <a class="no-underline">
                Documentation Generator
              </a>
            </div>
            <div id="sidebar-collapse-7" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/documentation/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/documentation/markdown">Markdown</a></li>
<li class=""><a href="/origen/guides/documentation/linking">Linking</a></li>
<li class=""><a href="/origen/guides/documentation/styling">Styling</a></li>
<li class=""><a href="/origen/guides/documentation/testing">Testing</a></li>
<li class=""><a href="/origen/guides/documentation/api">API Generation</a></li>
<li class=""><a href="/origen/guides/documentation/deploying">Deploying</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-8">
              <a class="no-underline">
                Plugins
              </a>
            </div>
            <div id="sidebar-collapse-8" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/plugins/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/plugins/importing">Using a Plugin</a></li>
<li class=""><a href="/origen/guides/plugins/creating">Creating a Plugin</a></li>
<li class=""><a href="/origen/guides/plugins/current">Current Plugin</a></li>
<li class=""><a href="/origen/guides/plugins/environment">Dev Environment</a></li>
<li class=""><a href="/origen/guides/plugins/development">Dev Considerations</a></li>
<li class=""><a href="/origen/guides/plugins/paths">Paths &amp; Origen.root</a></li>
<li class=""><a href="/origen/guides/plugins/app">Config &amp; Origen.app</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-9">
              <a class="no-underline">
                Miscellaneous
              </a>
            </div>
            <div id="sidebar-collapse-9" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/misc/revisioncontrol">Revision Control</a></li>
<li class=""><a href="/origen/guides/misc/remotes">Origen Remotes</a></li>
<li class=""><a href="/origen/guides/misc/lint">Lint Testing</a></li>
<li class=""><a href="/origen/guides/misc/session">Session Store</a></li>
<li class=""><a href="/origen/guides/misc/lsf">LSF API</a></li>
<li class=""><a href="/origen/guides/misc/users">Users, Emails &amp; Maillists</a></li>
<li class=""><a href="/origen/guides/misc/coreext">Ruby Extensions</a></li>
<li class=""><a href="/origen/guides/misc/logger">Logger</a></li>
<li class=""><a href="/origen/guides/misc/commands">Adding Commands</a></li>
<li class=""><a href="/origen/guides/misc/commandsov">Overriding Commands</a></li>
<li class=""><a href="/origen/guides/misc/callbacks">Callbacks</a></li>
<li class=""><a href="/origen/guides/misc/appcallbacks">Application Callbacks</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-10">
              <a class="no-underline">
                Advanced Topics
              </a>
            </div>
            <div id="sidebar-collapse-10" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/advanced/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/advanced/invocations">Invocation Customization</a></li>
<li class=""><a href="/origen/guides/advanced/newapps">Custom App Generators</a></li>
                </ul>
              </div>
            </div>
          </div>
      

        </div>

    </div>
  </div>

  <div class="col-md-9 nav-page-container">
    <article class="search-results">

      <h3 class="topic-title">Models</h3>

      <h2 class="topic-subtitle">Registers</h2>

      <hr>

      <p>When modelling semiconductor IP, there will almost always be a need to define register
and bit maps and Origen provides an API specifically for this purpose.</p>

      <p>When modelling silicon with Origen, the hardware should be the guide as to
where logic or attributes should go and if you have followed the advice so far
then you will already have a model framework that closely resembles the physical hardware.
The registers then, are simply instantiated within the model of the corresponding hardware
that owns them.</p>

      <div>    
  <a class="anchor" name="Defining_Registers"></a>          
  <h4><a href="#Defining_Registers">Defining Registers</a></h4>          
</div>

      <p>Registers should be defined as part of the object initialization process, but to avoid the
initialize method growing out of hand it is recommended that you instantiate registers in a
dedicated method that is called upon initialization.</p>

      <p>When defining registers you can either take the approach of defining them all up front
or defining them individually on an as-needed basis - the latter is recommended as it is the most
efficient in terms of effort.</p>

      <p>Here is an example of how to define this register in our memory map:</p>

      <p><img src="/origen/img/reg1.png" style="margin-left: 70px; width: 700px; height: 255px;"></p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># file: lib/nvm/analog_t921.rb</span>
<span style="color:#080;font-weight:bold">module</span> <span style="color:#B06;font-weight:bold">NVM</span>
  <span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ANALOG_T921</span>
    include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">Model</span>

    <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>(options={})
      instantiate_registers(options)
    <span style="color:#080;font-weight:bold">end</span>

    <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">instantiate_registers</span>(options={})
      reg <span style="color:#A60">:ctrl</span>, <span style="color:#00D">0x0024</span>, <span style="color:#606">size</span>: <span style="color:#00D">16</span> <span style="color:#080;font-weight:bold">do</span> |reg|
        reg.bit <span style="color:#00D">7</span>, <span style="color:#A60">:coco</span>, <span style="color:#606">access</span>: <span style="color:#A60">:ro</span>
        reg.bit <span style="color:#00D">6</span>, <span style="color:#A60">:aien</span>
        reg.bit <span style="color:#00D">5</span>, <span style="color:#A60">:diff</span>
        reg.bit <span style="color:#00D">4</span>..<span style="color:#00D">0</span>, <span style="color:#A60">:adch</span>, <span style="color:#606">reset</span>: <span style="color:#00D">0x1F</span>
      <span style="color:#080;font-weight:bold">end</span>
    <span style="color:#080;font-weight:bold">end</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>Some points to note in the above code:</p>

      <ul>
        <li>Even though we have not used it we have continued the practice of setting up every method with
an optional option argument and we have passed this between method calls - i.e. we passed the
initialize options when calling instantiate_registers. This keeps things extremely flexible for
the future and means that it is easy to influence the register instantiation externally, for
example: <code>NVM::ANALOG_T921.new(include_test_registers: true)</code>
</li>
        <li>The <code>reg</code> method takes a name, address and size as arguments. The size is optional
and is 32 by default.</li>
        <li>Bit definitions are contained within the <code>do..end</code> block passed to the <code>reg</code>
method. By default bits are writable and will reset to 0, but this can be overridden as shown
in the example.</li>
        <li>When defining bits the size is 1 by default and the reset state is 0 by default, these can be
overridden on an as needed basis as shown above.</li>
      </ul>

      <div>    
  <a class="anchor" name="Accessing_Registers"></a>          
  <h4><a href="#Accessing_Registers">Accessing Registers</a></h4>          
</div>

      <p>Origen will automatically create accessor methods for the register and its bits, the above register
would be accessed like this:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#d70">$dut</span>.nvm.analog.ctrl         <span style="color:#777"># =&gt; &lt;register object&gt;</span>
<span style="color:#d70">$dut</span>.nvm.analog.ctrl.adch    <span style="color:#777"># =&gt; &lt;subset of bits&gt;</span>
</pre></div>
</div>
      </div>

      <p>The Origen console will show a nice graphical representation of the register which reflects its
current state, this can be very useful when debugging or more generally as an interactive
version of the block guide:</p>

      <div class="language-text highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>&gt; origen i

&gt;&gt; $dut.nvm.analog.ctrl
=&gt;
0x24 - :ctrl
  ================================================================================================================
  |     15      |     14      |     13      |     12      |     11      |     10      |      9      |      8      |
  |             |             |             |             |             |             |             |             |
  |             |             |             |             |             |             |             |             |
  ----------------------------------------------------------------------------------------------------------------
  |      7      |      6      |      5      |      4      |      3      |      2      |      1      |      0      |
  |    :coco    |    :aien    |    :diff    |                             :adch[4:0]                              |
  |    0(RO)    |      0      |      0      |                                0x1F                                 |
  ----------------------------------------------------------------------------------------------------------------
</pre></div>
</div>
      </div>

      <p>Origen supports some more verbose APIs that you may see used in some codebases or documentation,
these are now considered legacy APIs but are equivalent to the above:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#d70">$dut</span>.nvm.analog.reg(<span style="color:#A60">:ctrl</span>)
<span style="color:#d70">$dut</span>.nvm.analog.reg(<span style="color:#A60">:ctrl</span>).bits(<span style="color:#A60">:adch</span>)
<span style="color:#d70">$dut</span>.nvm.analog.reg(<span style="color:#A60">:ctrl</span>)[<span style="color:#A60">:adch</span>]
</pre></div>
</div>
      </div>

      <p>Origen supports Verilog style part selects to access an ad-hoc subset of bits, although unfortunately
<code>[3:0]</code> is not valid Ruby and <code>[3..0]</code> is used instead.</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#d70">$dut</span>.nvm.analog.ctrl[<span style="color:#00D">1</span>]           <span style="color:#777"># =&gt; bit 1 of the register</span>
<span style="color:#d70">$dut</span>.nvm.analog.ctrl.adch[<span style="color:#00D">1</span>]      <span style="color:#777"># =&gt; bit 1 of the adch bits</span>
<span style="color:#d70">$dut</span>.nvm.analog.ctrl[<span style="color:#00D">3</span>..<span style="color:#00D">0</span>]
<span style="color:#d70">$dut</span>.nvm.analog.ctrl.adch[<span style="color:#00D">1</span>..<span style="color:#00D">0</span>]
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Bit_Order_and_Serial_Processing"></a>          
  <h4><a href="#Bit_Order_and_Serial_Processing">Bit Order and Serial Processing</a></h4>          
</div>

      <p>By default, a register is defined with its LSB in bit position 0, this can be changed to the MSB at position 0 by setting the
<code>bit_order</code> attribute as shown below:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>reg <span style="color:#A60">:ctrl</span>, <span style="color:#00D">0x0024</span>, <span style="color:#606">size</span>: <span style="color:#00D">16</span>, <span style="color:#606">bit_order</span>: <span style="color:#A60">:msb0</span> <span style="color:#080;font-weight:bold">do</span> |reg|
  <span style="color:#777"># Bit definitions would be exactly the same as the above example</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>A register with the MSB in bit position 0 will appear reversed in the console view, compare the following to the earlier example:</p>

      <div class="language-text highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>&gt; origen i

&gt;&gt; $dut.nvm.analog.ctrl
=&gt;
0x24 - :ctrl
  ================================================================================================================
  |      0      |      1      |      2      |      3      |      4      |      5      |      6      |      7      |
  |                             :adch[4:0]                              |    :diff    |    :aien    |    :coco    |
  |                                0x1F                                 |      0      |      0      |    0(RO)    |
  ----------------------------------------------------------------------------------------------------------------
  |      8      |      9      |     10      |     11      |     12      |     13      |     14      |     15      |
  |             |             |             |             |             |             |             |             |
  |             |             |             |             |             |             |             |             |
  ----------------------------------------------------------------------------------------------------------------
</pre></div>
</div>
      </div>

      <p>When serially processing a register (in a pattern driver for example), some of the APIs will change order depending on the
<code>bit_order</code> value.
Here is a summary of the APIs that are available for serially processing a register and how they behave in respect to this
attribute:</p>

      <ul>
        <li>shift_out / shift_out_with_index - A logical rather than a physical shift, this will process the bits with the LSB going first
and it will behave the same regardless of the register’s bit order.</li>
        <li>reverse_shift_out / reverse_shift_out_with_index - As above, but MSB first.</li>
        <li>shift_out_left / shift_out_left_with_index - Think of this as a physical shift, it will process the top-left bit of the
register first and which bit that is will depend on the bit order.</li>
        <li>shift_out_right / shift_out_right_with_index - As above, but with the bottom-right bit going first.</li>
      </ul>

      <p>All of these APIs behave like this:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>myreg.shift_out_left_with_index <span style="color:#080;font-weight:bold">do</span> |bit, i|
  <span style="color:#777"># This block will execute for each bit in the register</span>
  <span style="color:#777"># *bit* is a bit object (instance of Origen::Reg::Bit)</span>
  <span style="color:#777"># *i* is the iteration index, 0, 1, 2, etc. Note that this is only available for the _with_index versions.</span>
  bist_shift(bit)
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Base_Addresses"></a>          
  <h4><a href="#Base_Addresses">Base Addresses</a></h4>          
</div>

      <p>When defining registers the address specified should be the local address within the owning
IP block.</p>

      <p>Base addresses can be passed in within the sub block definition, <code>base_address</code> is an official
option that Origen will recognize and automatically deal with.</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># lib/nvm/nvm_m682.rb</span>
sub_block <span style="color:#A60">:analog</span>, <span style="color:#606">class_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">ANALOG_T921</span><span style="color:#710">"</span></span>, <span style="color:#606">base_address</span>: <span style="color:#00D">0x4000_0000</span>
</pre></div>
</div>
      </div>

      <p>Registers will automatically pick up the base address of their parent, the local address can
be accessed via the <code>offset</code> method:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#d70">$dut</span>.nvm.analog.ctrl.address   <span style="color:#777"># =&gt; 0x4000_0024</span>
<span style="color:#d70">$dut</span>.nvm.analog.ctrl.offset    <span style="color:#777"># =&gt; 0x24</span>
</pre></div>
</div>
      </div>

      <p>Note that when resolving a base address Origen will look right up the hierarchy until it reaches the top
level object and all base addresses in that branch of the tree will be added together.</p>

      <div>    
  <a class="anchor" name="Register_Domains"></a>          
  <h4><a href="#Register_Domains">Register Domains</a></h4>          
</div>

      <p>An API is available to model register domains, where domain could mean what bus or clk domain that the
register is on, or any similar concept.</p>

      <p>Domains must first be declared in the object that owns them and then they can be passed to sub block
definitions:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#606">domain</span>: <span style="color:#A60">:ips</span>
<span style="color:#606">domain</span>: <span style="color:#A60">:ahb</span>, <span style="color:#606">endian</span>: <span style="color:#A60">:little</span>

sub_block <span style="color:#A60">:analog</span>, <span style="color:#606">class_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">ANALOG_T921</span><span style="color:#710">"</span></span>, <span style="color:#606">base_address</span>: <span style="color:#00D">0x4000_0000</span>, <span style="color:#606">domain</span>: <span style="color:#A60">:ips</span>
</pre></div>
</div>
      </div>

      <p>The domain attribute will also accept an array of multiple domain names as required.</p>

      <p>The child block and any of its registers will then be associated with the given domains:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#d70">$dut</span>.nvm.analog.domains            <span style="color:#777"># =&gt; {ips: &lt;object&gt;}</span>
<span style="color:#d70">$dut</span>.nvm.analog.ctrl.domains       <span style="color:#777"># =&gt; {ips: &lt;object&gt;}</span>
</pre></div>
</div>
      </div>

      <p>Note that the <code>domains</code> method returns a hash pointing to objects that represent the domains,
this can therefore be associated with attributes such as the <code>:endian</code> attribute in the
example above.</p>

      <p>See the <a href="/origen/api/Origen/Registers/Domain.html">Domain Class API</a> for an up to date list of
supported attributes.</p>

      <div>    
  <a class="anchor" name="Per-Domain_Base_Addresses"></a>          
  <h4><a href="#Per-Domain_Base_Addresses">Per-Domain Base Addresses</a></h4>          
</div>

      <p>Domain specific base addresses can be assigned to a sub-block by passing a hash to the <code>:base_address</code>
option as shown in the example below:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Top</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">TopLevel</span>

  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>
    domain <span style="color:#A60">:ips</span>
    domain <span style="color:#A60">:ahb</span>

    sub_block <span style="color:#A60">:subx1</span>, <span style="color:#606">class_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">SubX</span><span style="color:#710">"</span></span>, <span style="color:#606">base_address</span>: <span style="color:#00D">0x1000_0000</span>
    sub_block <span style="color:#A60">:subx2</span>, <span style="color:#606">class_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">SubX</span><span style="color:#710">"</span></span>, <span style="color:#606">base_address</span>: { <span style="color:#606">ips</span>: <span style="color:#00D">0x2000_0000</span>, <span style="color:#606">ahb</span>: <span style="color:#00D">0x3000_0000</span> }
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SubX</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">Model</span>

  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>
    reg <span style="color:#A60">:reg1</span>, <span style="color:#00D">0x200</span> <span style="color:#080;font-weight:bold">do</span>
      bits <span style="color:#00D">31</span>..<span style="color:#00D">0</span>, <span style="color:#A60">:data</span>
    <span style="color:#080;font-weight:bold">end</span>
    sub_block <span style="color:#A60">:suby1</span>, <span style="color:#606">class_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">SubY</span><span style="color:#710">"</span></span>, <span style="color:#606">domain</span>: <span style="color:#A60">:ips</span>
    sub_block <span style="color:#A60">:suby2</span>, <span style="color:#606">class_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">SubY</span><span style="color:#710">"</span></span>, <span style="color:#606">domain</span>: <span style="color:#A60">:ahb</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SubY</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">Model</span>

  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>
    reg <span style="color:#A60">:reg1</span>, <span style="color:#00D">0x300</span> <span style="color:#080;font-weight:bold">do</span>
      bits <span style="color:#00D">31</span>..<span style="color:#00D">0</span>, <span style="color:#A60">:data</span>
    <span style="color:#080;font-weight:bold">end</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#d70">$dut</span> = <span style="color:#036;font-weight:bold">Top</span>.new
<span style="color:#d70">$dut</span>.subx1.reg1.address                <span style="color:#777"># =&gt; 0x1000_0200</span>
<span style="color:#d70">$dut</span>.subx1.suby1.reg1.address          <span style="color:#777"># =&gt; 0x1000_0300</span>
<span style="color:#d70">$dut</span>.subx1.suby2.reg1.address          <span style="color:#777"># =&gt; 0x1000_0300</span>
<span style="color:#777"># Where a register falls into the case where multiple domains are specified for it, you must</span>
<span style="color:#777"># indicate the one you want</span>
<span style="color:#d70">$dut</span>.subx1.reg1.address(<span style="color:#606">domain</span>: <span style="color:#A60">:ips</span>)  <span style="color:#777"># =&gt; 0x2000_0200</span>
<span style="color:#d70">$dut</span>.subx1.reg1.address(<span style="color:#606">domain</span>: <span style="color:#A60">:ahb</span>)  <span style="color:#777"># =&gt; 0x3000_0200</span>
<span style="color:#d70">$dut</span>.subx2.suby1.reg1.address          <span style="color:#777"># =&gt; 0x2000_0300</span>
<span style="color:#d70">$dut</span>.subx2.suby2.reg1.address          <span style="color:#777"># =&gt; 0x3000_0300</span>
</pre></div>
</div>
      </div>

      <p>In the case where a register owned by a child sub-block is not in any of the domains listed in the base address
hash then it will pick up a base address of 0.</p>

      <p>An alternative default can be set by adding a <code>:default</code> key to the hash:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>sub_block <span style="color:#A60">:subx2</span>, <span style="color:#606">class_name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">SubX</span><span style="color:#710">"</span></span>, <span style="color:#606">base_address</span>: { <span style="color:#606">default</span>: <span style="color:#00D">0x1000_0000</span>, <span style="color:#606">ips</span>: <span style="color:#00D">0x2000_0000</span>, <span style="color:#606">ahb</span>: <span style="color:#00D">0x3000_0000</span> }
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Documenting_Registers"></a>          
  <h4><a href="#Documenting_Registers">Documenting Registers</a></h4>          
</div>

      <p>Registers can be documented by Ruby comments like this:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># ** MGATE Clock Divider Register **</span>
<span style="color:#777"># The MCLKDIV register is used to divide down the frequency of the HBOSCCLK input. If the MCLKDIV</span>
<span style="color:#777"># register is set to value "N", then the output (beat) frequency of the clock divider is OSCCLK / (N+1). The</span>
<span style="color:#777"># resulting beats are, in turn, counted by the PTIMER module to control the duration of Flash high-voltage</span>
<span style="color:#777"># operations.</span>
reg <span style="color:#A60">:mclkdiv</span>, <span style="color:#00D">0x0003</span>, <span style="color:#606">size</span>: <span style="color:#00D">16</span> <span style="color:#080;font-weight:bold">do</span> |reg|
  <span style="color:#777"># **Oscillator (Hi)** - Firmware FMU clk source selection. (Note that in addition to this firmware-controlled bit, the</span>
  <span style="color:#777"># FMU clock source is also dependent on test and power control discretes).</span>
  <span style="color:#777">#</span>
  <span style="color:#777"># 0 | FMU clock is the externally supplied bus clock ipg_clk</span>
  <span style="color:#777"># 1 | FMU clock is the internal oscillator from the TFS hardblock</span>
  reg.bit <span style="color:#00D">15</span>, <span style="color:#A60">:osch</span>, <span style="color:#606">reset</span>: <span style="color:#00D">1</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>The descriptions are then programmatically accessible via the following methods:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>mclkdiv.full_name                          <span style="color:#777"># =&gt; "MGATE Clock Divider Register"</span>
mclkdiv.description(<span style="color:#606">include_name</span>: <span style="color:#069">false</span>)   <span style="color:#777"># =&gt; ["The MCLKDIV register is...", "register is set...", ...] </span>

bit = mclkdiv.osch
bit.full_name  <span style="color:#777"># =&gt; "Oscillator (Hi)"</span>
bit.description(<span style="color:#606">include_name</span>: <span style="color:#069">false</span>, <span style="color:#606">include_bit_values</span>: <span style="color:#069">false</span>)  <span style="color:#777"># =&gt; ["Firmware FMU clk...", "FMU clock...", ...] </span>
bit.bit_value_descriptions[<span style="color:#00D">0</span>]   <span style="color:#777"># =&gt; "FMU clock is the externally supplied bus block ipg_clk"</span>
bit.bit_value_descriptions[<span style="color:#00D">1</span>]   <span style="color:#777"># =&gt; "FMU clock is the internal oscillator from the TFS hardblock"</span>
</pre></div>
</div>
      </div>

      <p>Most commonly these descriptions will be used for documentation, for example the 
<a href="http://origen-sdk.org/doc_helpers/">Documentation Helpers</a> plugin provides
helpers to easily present registers in Origen documentation as shown here -
<a href="http://origen-sdk.org/doc_helpers/latest/examples/register/">Register Helpers</a>.</p>

      <p>The descriptions can also be supplied as in-line arguments, <strong>but doing so overrides any comment-based
documentation.</strong>  Thus, it is intended to be used
only when the register is being declared programmatically by an importer and humans
should stick to the above API for clarity:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>reg <span style="color:#A60">:mclkdiv</span>, <span style="color:#00D">0x0003</span>, <span style="color:#606">size</span>: <span style="color:#00D">16</span>, <span style="color:#606">description</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">** MGATE Clock Divider Register **</span><span style="color:#b0b">\n</span><span style="color:#D20">The MCLKDIV reg...</span><span style="color:#710">"</span></span> <span style="color:#080;font-weight:bold">do</span> |reg|
  reg.bit <span style="color:#00D">15</span>, <span style="color:#A60">:osch</span>, <span style="color:#606">reset</span>: <span style="color:#00D">1</span>, <span style="color:#606">description</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">** Oscillator (Hi) ** - Firmware FMU clk source selection...</span><span style="color:#710">"</span></span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Defining_Application-Specific_Metadata"></a>          
  <h4><a href="#Defining_Application-Specific_Metadata">Defining Application-Specific Metadata</a></h4>          
</div>

      <p>Within a given application it may be desired to attach some meta-data to a register or bits to
track application-specific properties, for example whether a register is only readable in test
mode or not.</p>

      <p>The object owning the register can define a default set of custom attributes and then override
these for specific registers and bits.
Here is an example:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">instantiate_registers</span>(options={})

  default_reg_metadata <span style="color:#080;font-weight:bold">do</span> |reg|
    reg.user_reg = <span style="color:#069">false</span>
  <span style="color:#080;font-weight:bold">end</span>

  default_bit_metadata <span style="color:#080;font-weight:bold">do</span> |bit|
    bit.time_to_respond = <span style="color:#00D">0</span>
  <span style="color:#080;font-weight:bold">end</span>

  reg <span style="color:#A60">:fstat</span>, <span style="color:#00D">0x0001</span>, <span style="color:#606">size</span>: <span style="color:#00D">8</span>, <span style="color:#606">user_reg</span>: <span style="color:#069">true</span> <span style="color:#080;font-weight:bold">do</span> |reg|
    reg.bit <span style="color:#00D">8</span>, <span style="color:#A60">:ccif</span>, <span style="color:#606">time_to_respond</span>: <span style="color:#00D">10</span>.us
    reg.bit <span style="color:#00D">7</span>, <span style="color:#A60">:rdcolerr</span>
    reg.bit <span style="color:#00D">6</span>, <span style="color:#A60">:accerr</span>, <span style="color:#606">access</span>: <span style="color:#A60">:w1c</span>
    reg.bit <span style="color:#00D">5</span>, <span style="color:#A60">:fpviol</span>, <span style="color:#606">access</span>: <span style="color:#A60">:w1c</span>
    reg.bit <span style="color:#00D">0</span>, <span style="color:#A60">:mgstat</span>, <span style="color:#606">access</span>: <span style="color:#A60">:ro</span>
  <span style="color:#080;font-weight:bold">end</span>

  reg <span style="color:#A60">:mclkdiv</span>, <span style="color:#00D">0x0002</span>, <span style="color:#606">size</span>: <span style="color:#00D">16</span> <span style="color:#080;font-weight:bold">do</span> |reg|
    reg.bit <span style="color:#00D">15</span>, <span style="color:#A60">:osch</span>, <span style="color:#606">reset</span>: <span style="color:#00D">1</span>
    reg.bit <span style="color:#00D">13</span>..<span style="color:#00D">12</span>, <span style="color:#A60">:mode_rdy</span>, <span style="color:#606">writable</span>: <span style="color:#069">false</span>
    reg.bit <span style="color:#00D">10</span>, <span style="color:#A60">:eccen</span>, <span style="color:#606">reset</span>: <span style="color:#00D">1</span>
    reg.bit <span style="color:#00D">9</span>..<span style="color:#00D">8</span>, <span style="color:#A60">:cmdloc</span>
    reg.bit <span style="color:#00D">7</span>..<span style="color:#00D">0</span>, <span style="color:#A60">:div</span>
  <span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">end</span>

fstat.user_reg?     <span style="color:#777"># =&gt; true</span>
mclkdiv.user_reg?   <span style="color:#777"># =&gt; false</span>

fstat.ccif.time_to_respond     <span style="color:#777"># =&gt; 10us</span>
fstat.accerr.time_to_respond   <span style="color:#777"># =&gt; 0</span>
</pre></div>
</div>
      </div>

      <p>Global attributes can also be added, when done in this way the meta data
will be applied to all registers within the scope of an application.</p>

      <p>If the same attribute is later declared within a class as above then the value
from the class will take precedence.</p>

      <p>As with the above example the attribute values can be overridden when
defining registers and bits.</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">Registers</span>.default_reg_metadata <span style="color:#080;font-weight:bold">do</span> |reg|
  reg.attr_x        <span style="color:#777"># Adds the attribute with a default value of nil</span>
  reg.attr_y = <span style="color:#00D">10</span>   <span style="color:#777"># Adds the attribute with a default value of 10</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">Registers</span>.default_bit_metadata <span style="color:#080;font-weight:bold">do</span> |reg|
  reg.attr_z = <span style="color:#00D">15</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>Plugins may also use this approach to globally extend the attributes of
registers and bits.</p>

      <div>    
  <a class="anchor" name="Importing_Registers"></a>          
  <h4><a href="#Importing_Registers">Importing Registers</a></h4>          
</div>

      <p>If the register data for the target device/module is already mastered somewhere else, for
example in IP-XACT format, then it can be imported directly to save having to manually duplicate the
register definitions in Origen.
This will generate the exact same models of the registers as if they had been declared directly
into Origen.</p>

      <p>This import (and export) functionality is provided via the <a href="http://origen-sdk.org/cross_origen/">Cross Origen</a>
plugin and this should be consulted directly for the latest information on the API and the supported formats.</p>

      <p>However here is a brief example of how it can be used to import from a local XML file:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># lib/nvm/nvm_m682.rb</span>
<span style="color:#080;font-weight:bold">module</span> <span style="color:#B06;font-weight:bold">NVM</span>
  <span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">NVM_M682</span>
    include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">Model</span>
    include <span style="color:#036;font-weight:bold">CrossOrigen</span>

    <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>(options={})
      cr_import(<span style="color:#606">path</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="background-color:hsla(0,0%,0%,0.07);color:black"><span style="font-weight:bold;color:#666">#{</span><span style="color:#036;font-weight:bold">Origen</span>.root<span style="font-weight:bold;color:#666">}</span></span><span style="color:#D20">/ipxact_files/nvm_m682.xml</span><span style="color:#710">"</span></span>)
    <span style="color:#080;font-weight:bold">end</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Understanding_the_Origen_Register_Model"></a>          
  <h4><a href="#Understanding_the_Origen_Register_Model">Understanding the Origen Register Model</a></h4>          
</div>

      <p>By using the above API Origen has now built an accurate register model that will look and behave like the
real register on silicon.
This is extremely convenient and useful for pattern generation as we will see later, but it can also
be very useful for other applications such as <a href="http://origen-sdk.org/doc_helpers/examples/register/">generating documentation</a>.</p>

      <p>Each register created by Origen is an instance of the
<a href="/origen/api/Origen/Registers/Reg.html">Origen::Registers::Reg</a>
class.
This does not by itself provide that much functionality and its main purpose is as a container for the
individual bits that make up the register.</p>

      <p>Each bit is an instance of the <a href="/origen/api/Origen/Registers/Bit.html">Origen::Registers::Bit</a>
class. The main function of the bit object is to store a single bit of data and to track the state of various
attribute flags that monitor such things as whether the bit is writable, or readable, or whether a particular bit
is required to be read during a test pattern operation.</p>

      <p>Similar to the <code>Reg</code> the <code>Bit</code> API is mainly for internal use.</p>

      <p>Instead the public facing API is implemented by the <a href="/origen/api/Origen/Registers/BitCollection.html">Origen::Registers::BitCollection</a>
class.
This class provides a consistent API whether you are working with an entire register or a subset of bits in
the register.</p>

      <p>By calling <code>ctrl</code> a new <code>BitCollection</code> is generated on the fly and populated
with all of the bit objects contained in the register.
Similarly if you call <code>ctrl.adch</code> then a <code>BitCollection</code> will be
returned that contains only the subset of requested bits.</p>

      <div>    
  <a class="anchor" name="Examples"></a>          
  <h4><a href="#Examples">Examples</a></h4>          
</div>

      <p>Here are a few examples of working with the register that we recently added:</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#d70">$dut</span> = <span style="color:#036;font-weight:bold">SOC</span>::<span style="color:#036;font-weight:bold">EAGLE_M352</span>.new(<span style="color:#606">version</span>: <span style="color:#00D">1</span>)

reg = <span style="color:#d70">$dut</span>.nvm.analog.ctrl

reg.data                  <span style="color:#777"># =&gt; 31</span>
reg.data.to_hex           <span style="color:#777"># =&gt; "0x1F"</span>

<span style="color:#777"># Only bits that are writable can hold data, the same as real silicon</span>
reg.write(<span style="color:#00D">0xFFFF</span>)
reg.data.to_hex           <span style="color:#777"># =&gt; "0x7F"</span>
  
<span style="color:#777"># Individual bits can be manipulated</span>
reg.adch.data             <span style="color:#777"># =&gt; 31</span>
reg.adch.write(<span style="color:#00D">0</span>)       
reg.adch.data             <span style="color:#777"># =&gt; 0</span>
                          
reg.data.to_hex           <span style="color:#777"># =&gt; "0x60"</span>

<span style="color:#777"># Bits can be marked for read</span>
reg.is_to_be_read?        <span style="color:#777"># =&gt; false</span>
reg.coco.read
reg.coco.is_to_be_read?   <span style="color:#777"># =&gt; true</span>
reg.aien.is_to_be_read?   <span style="color:#777"># =&gt; false</span>
reg.is_to_be_read?        <span style="color:#777"># =&gt; true</span>

<span style="color:#777"># The register can be reset</span>
reg.reset
reg.is_to_be_read?        <span style="color:#777"># =&gt; false</span>
reg.data.to_hex           <span style="color:#777"># =&gt; "0x1F"</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="More_Examples"></a>          
  <h4><a href="#More_Examples">More Examples</a></h4>          
</div>

      <p>Here are some addtional examples showing how to iterate through a model’s registers</p>

      <div class="language-ruby highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Top</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">TopLevel</span>

  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>
    reg <span style="color:#A60">:adc0_cfg</span>, <span style="color:#00D">0x200</span> <span style="color:#080;font-weight:bold">do</span>
      bits <span style="color:#00D">31</span>..<span style="color:#00D">0</span>, <span style="color:#A60">:data</span>
    <span style="color:#080;font-weight:bold">end</span>
    reg <span style="color:#A60">:adc1_cfg</span>, <span style="color:#00D">0x300</span> <span style="color:#080;font-weight:bold">do</span>
      bits <span style="color:#00D">31</span>..<span style="color:#00D">0</span>, <span style="color:#A60">:data</span>
    <span style="color:#080;font-weight:bold">end</span>
    reg <span style="color:#A60">:dac_cfg</span>, <span style="color:#00D">0x400</span> <span style="color:#080;font-weight:bold">do</span>
      bits <span style="color:#00D">31</span>..<span style="color:#00D">0</span>, <span style="color:#A60">:data</span>
    <span style="color:#080;font-weight:bold">end</span>
    reg <span style="color:#A60">:status</span>, <span style="color:#00D">0x100</span> <span style="color:#080;font-weight:bold">do</span>
      bits <span style="color:#00D">31</span>..<span style="color:#00D">0</span>, <span style="color:#A60">:data</span>
    <span style="color:#080;font-weight:bold">end</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#d70">$dut</span> = <span style="color:#036;font-weight:bold">Top</span>.new

<span style="color:#777"># Iterate over ALL registers (:adc0_cfg, :adc1_cfg, :dac_cfg, :status)</span>
<span style="color:#d70">$dut</span>.regs.each <span style="color:#080;font-weight:bold">do</span> |r|
  <span style="color:#777"># do something with register r</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#777"># Iterate over all registers matching a regular expression</span>
<span style="color:#777"># Ex 1: Only ADC cfg registers (:adc0_cfg, :adc1_cfg)</span>
<span style="color:#d70">$dut</span>.regs(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">/acd</span><span style="color:#D20">\d</span><span style="color:#D20">_cfg/</span><span style="color:#710">'</span></span>).each <span style="color:#080;font-weight:bold">do</span> |r|
  <span style="color:#777"># do something with register r</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#777"># Ex 2: Any cfg registers (:adc0_cfg, :adc1_cfg, :dac_cfg)</span>
<span style="color:#d70">$dut</span>.regs(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">/cfg/</span><span style="color:#710">'</span></span>).each <span style="color:#080;font-weight:bold">do</span> |r|
  <span style="color:#777"># do something with register r</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div style="position: relative">
  <hr>
  <div>    
  <a class="anchor" name="Comments"></a>          
  <h4><a href="#Comments">Comments</a></h4>          
</div>
</div>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'origen-sdk';
    var disqus_title;
    var disqus_url = 'http://' + window.location.hostname + window.location.pathname;

    disqus_title = $("h1").text();
    if (disqus_title.length == 0) {
      disqus_title = $("h2").text();
    }
    if (disqus_title.length == 0) {
      disqus_title = $("h3").text();
    }
    if (disqus_title.length == 0) {
      disqus_title = $("title").text();
    } else {
      disqus_title = disqus_title + ' (' + $("title").text() + ')';
    }

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>

    </article>
  </div>
</div>

<script src="/origen/search.js"></script>


      </div><!-- /.container -->
    

    <footer class="footer">
      <div class="container">
        <p class="pull-left text-muted">
          Generated with the <a href="http://origen-sdk.org">Origen Semiconductor Developer's Kit</a>
        </p>
        <p class="pull-right text-muted">Origen is released under the terms of the <a href="https://choosealicense.com/licenses/mit/">MIT license</a></p>
      </div>
    </footer>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="http://origen-sdk.org/js/lunr.min.js"></script>
    <script src="http://origen-sdk.org/js/highlight.js"></script>
    <script src="http://origen-sdk.org/js/custom.js"></script>
    
      <script>
        ((window.gitter = {}).chat = {}).options = {
          room: 'Origen-SDK/users'
        };
      </script>
      <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
    
  </body>
</html>
