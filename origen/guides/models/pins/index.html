<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta property="og:locale" content="en_US">
    <meta name="content-language" content="en_US">

    
    <title>Origen - Guides</title>
    <meta property="og:title" content="Origen - Guides">
    <meta name="twitter:title" content="Origen - Guides">
    <meta itemprop="name" content="Origen - Guides">
      
  
  
    <link rel="author" href="https://plus.google.com/u/1/b/106463981272125989995/106463981272125989">
  
  
    <meta property="og:url" content="http://origen-sdk.org/origen/guides/models/pins">
    <meta name="twitter:url" content="http://origen-sdk.org/origen/guides/models/pins">
  
  
    <meta property="og:image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta name="twitter:image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta itemprop="image" content="http://origen-sdk.org/favicon-260x260.png">
    <meta name="twitter:card" content="summary">
  
    <meta property="og:site_name" content="Origen - The Semiconductor Developer's Kit">
  
  
    <meta property="fb:admins" content="origensdk">
  
  
    <meta name="twitter:site" content="@origensdk">
  

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://origen-sdk.org/css/bootstrap_custom.css"></script>
    <!-- Load this up top to allow pages to execute JQuery snippets -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
        ga('create', 'UA-64455560-1', 'auto');
        ga('send', 'pageview');
      </script>
    

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="http://origen-sdk.org/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://origen-sdk.org/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://origen-sdk.org/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://origen-sdk.org/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://origen-sdk.org/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://origen-sdk.org/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://origen-sdk.org/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://origen-sdk.org/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="http://origen-sdk.org/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="http://origen-sdk.org/manifest.json">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
  </head>

  <body>
    
      <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top"><div class="container">
    <div class="navbar-header">
      <a href="/" class="navbar-brand" style="margin-top: -4px;">
        <img src="http://origen-sdk.org/img/origen-device.png" style="height:30px; margin-right: 2px; display: inline; margin-top: -2px;"><img src="http://origen-sdk.org/img/origen-text.png" style="height:15px; display: inline;"></a>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
<li class="dropdown ">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="tour">Tour <span class="caret"></span></a>
          <ul class="dropdown-menu" aria-labelledby="tour">
<li><a href="/origen/tour/basics">Basics</a></li>
            <li class="divider">
            </li>
<li><a href="/origen/tour/test-engineering">Test Engineers</a></li>
            <li><a href="/origen/tour/design-engineering">Design Engineers</a></li>
          </ul>
</li>
        <li class="active"><a href="/origen/guides/starting/introduction">Guides</a></li>
        <li class=""><a href="/origen/api">API</a></li>
        <li class=""><a href="https://github.com/Origen-SDK">Github</a></li>
        <li class=""><a href="/origen/community">Community</a></li>
        <li class=""><a href="/origen/release_notes">Release Notes</a></li>
        <li class=""><a href="/origen/plugins">Plugins</a></li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
</nav><div class="row">
  <div class="col-md-3 sidebar-nav-container">
    <div class="well sidebar-nav" style="margin-top: 20px;">
        <div id="search">
          <form style="margin-bottom: 15px;">
            <div class="input-group">
              <input class="form-control" type="search" placeholder="Search these docs..."><span class="input-group-btn">
                <button type="submit" class="btn btn-search">GO!</button>
              </span>
            </div>
          </form>
        </div>
        <div class="panel-group" id="sidebar-accordion">

          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-0">
              <a class="no-underline">
                Getting Started with Origen
              </a>
            </div>
            <div id="sidebar-collapse-0" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/starting/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/starting/core">Core concepts</a></li>
<li class=""><a href="/origen/guides/starting/installing">How to Install</a></li>
<li class=""><a href="/origen/guides/starting/installwin">How to Install (Windows)</a></li>
<li class=""><a href="/origen/guides/starting/company">Company Customization</a></li>
<li class=""><a href="/origen/guides/starting/gems">Understanding Gems</a></li>
<li class=""><a href="/origen/guides/starting/app">Creating a New App</a></li>
<li class=""><a href="/origen/guides/starting/commit">The Initial Commit</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-1">
              <a class="no-underline">
                Runtime Environment
              </a>
            </div>
            <div id="sidebar-collapse-1" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/runtime/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/runtime/mode">Mode</a></li>
<li class=""><a href="/origen/guides/runtime/environment">Environment</a></li>
<li class=""><a href="/origen/guides/runtime/target">Target</a></li>
<li class=""><a href="/origen/guides/runtime/production">Production Targets</a></li>
<li class=""><a href="/origen/guides/runtime/global">Global Setup</a></li>
<li class=""><a href="/origen/guides/runtime/loadorder">Load Order</a></li>
<li class=""><a href="/origen/guides/runtime/programming">Programming</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-2">
              <a class="no-underline">
                Models
              </a>
            </div>
            <div id="sidebar-collapse-2" class="panel-collapse collapse in">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/models/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/models/naming">Naming</a></li>
<li class=""><a href="/origen/guides/models/defining">Definition &amp; Hierarchy</a></li>
<li class=""><a href="/origen/guides/models/attributes">Adding Attributes</a></li>
<li class=""><a href="/origen/guides/models/versioning">Versioning</a></li>
<li class=""><a href="/origen/guides/models/bugs">Bugs &amp; Features</a></li>
<li class=""><a href="/origen/guides/models/modes">Package, Mode &amp; Configuration</a></li>
<li class=""><a href="/origen/guides/models/registers">Registers</a></li>
<li class="active"><a href="/origen/guides/models/pins">Pins</a></li>
<li class=""><a href="/origen/guides/models/hw">Hardware Attributes</a></li>
<li class=""><a href="/origen/guides/models/parameters">Parameters</a></li>
<li class=""><a href="/origen/guides/models/specs">Specifications</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-3">
              <a class="no-underline">
                Compiler (Views)
              </a>
            </div>
            <div id="sidebar-collapse-3" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/compiler/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/compiler/creating">Creating Templates</a></li>
<li class=""><a href="/origen/guides/compiler/subtemplates">Using Sub-Templates</a></li>
<li class=""><a href="/origen/guides/compiler/helpers">Helpers</a></li>
<li class=""><a href="/origen/guides/compiler/running">Running The Compiler</a></li>
<li class=""><a href="/origen/guides/compiler/inline">Inline Compiler</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-4">
              <a class="no-underline">
                Controllers
              </a>
            </div>
            <div id="sidebar-collapse-4" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/controllers/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/controllers/shadow">Shadow Controllers</a></li>
<li class=""><a href="/origen/guides/controllers/direct">Direct Controllers</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-5">
              <a class="no-underline">
                Pattern Generator
              </a>
            </div>
            <div id="sidebar-collapse-5" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/pattern/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/pattern/creating">Creating Patterns</a></li>
<li class=""><a href="/origen/guides/pattern/pins">Pins</a></li>
<li class=""><a href="/origen/guides/pattern/timing">Timing and Waiting</a></li>
<li class=""><a href="/origen/guides/pattern/registers">Registers</a></li>
<li class=""><a href="/origen/guides/pattern/documenting">Documenting Patterns</a></li>
<li class=""><a href="/origen/guides/pattern/name">Generating by Name</a></li>
<li class=""><a href="/origen/guides/pattern/j750">J750</a></li>
<li class=""><a href="/origen/guides/pattern/v93k">V93K</a></li>
<li class=""><a href="/origen/guides/pattern/ultraflex">UltraFlex</a></li>
<li class=""><a href="/origen/guides/pattern/custom">Custom Testers</a></li>
<li class=""><a href="/origen/guides/pattern/running">Running The PatGen</a></li>
                </ul>
</div>
            </div>
          </div>
      

        </div>

    </div>
  </div>

  <div class="col-md-9 nav-page-container">
    <article><h3 class="topic-title">Models</h3>

      <h2 class="topic-subtitle">Pins</h2>

      <hr>
<p>Origen provides a pin (and pin group) API that should be used to define and manipulate the
physical pins of the device.</p>

      <p>Pins are mainly intended to be defined on models that will be used for pattern generation
and where the pins represent the physical device pins that the tester can interact with.
However in its basic form a pin is just an object that can hold a data state and there
are probably some creative uses of the pin models outside of pattern generation.</p>

      <p>The pin API is made available to your model by including the
<code>Origen::TopLevel</code> or <code>Origen::Model</code> modules.</p>

      <p>While pins can be added
from any sub-module the ownership of all pins is always assigned to the top-level object,
this is reflecting real life where the pin is a physical property of the top-level SoC.
Therefore it is recommended that pin definitions are always made on the top-level object
and most modern Origen applications now take this approach.</p>

      <div>    
  <a class="anchor" name="Defining_Pins"></a>          
  <h4><a href="#Defining_Pins">Defining Pins</a></h4>          
</div>

      <p>Pins should be defined as part of the object initialization process, but to avoid the
initialize method growing out of hand it is recommended that pins are instantiated in a
dedicated method that is called upon initialization.</p>

      <p>Here is an example of how to define some JTAG interface pins in an SoC model:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MySoC</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">TopLevel</span>

  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>(options={})
    instantiate_pins(options)
  <span style="color:#080;font-weight:bold">end</span>

  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">instantiate_pins</span>(options={})
    add_pin <span style="color:#A60">:tclk</span>, <span style="color:#606">reset</span>: <span style="color:#A60">:drive_hi</span>
    add_pin <span style="color:#A60">:tdi</span>, <span style="color:#606">direction</span>: <span style="color:#A60">:input</span>
    add_pin <span style="color:#A60">:tdo</span>, <span style="color:#606">direction</span>: <span style="color:#A60">:output</span>
    add_pin <span style="color:#A60">:tms</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>Some points to note in the above code:</p>

      <ul>
<li>
<code>add_pin</code> will instantiate an instance of <a href="/origen/api/Origen/Pins/Pin.html">Origen::Pins::Pin</a>
</li>
        <li>Each pin must be given a name, or handle, similar to how registers are named. However unlike
registers <strong>the name must not only be unique within the parent object but it must also be unique
within the scope of all objects instantiated by a target</strong>. The easiest way to comply with this requirement
is to follow the advice of handling all pin definitions at the top level.</li>
        <li>Pins are initialized in the don’t care state by default, an alternative default state can be specified via
the <code>:reset</code> option.</li>
        <li>Pins are I/Os by default, however they can be defined as input or output only by using the <code>:direction</code>
option.</li>
      </ul>
<p>Pins are accessed via the <code>pin</code> method:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#d70">$dut</span>.pin(<span style="color:#A60">:tdi</span>)     <span style="color:#777"># =&gt; &lt;pin object&gt;</span>
</pre></div>
</div>
      </div>

      <p>Note that pins can be accessed locally from any object that includes the <code>Origen::Model</code> module:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#d70">$dut</span>.pin(<span style="color:#A60">:tdi</span>) == <span style="color:#d70">$dut</span>.memories.rambist.pin(<span style="color:#A60">:tdi</span>)   <span style="color:#777"># =&gt; true</span>
</pre></div>
</div>
      </div>

      <p>However references to pins within a sub-block would typically use an alias that reflected the pin function related to
that sub-block.</p>

      <p>Pin aliases are added like this:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>has_pin?(<span style="color:#A60">:tdi</span>)               <span style="color:#777"># =&gt; true</span>
has_pin?(<span style="color:#A60">:bisti</span>)             <span style="color:#777"># =&gt; false</span>

add_pin_alias <span style="color:#A60">:bisti</span>, <span style="color:#A60">:tdi</span>

has_pin?(<span style="color:#A60">:bisti</span>)             <span style="color:#777"># =&gt; true</span>
pin(<span style="color:#A60">:bisti</span>) == pin(<span style="color:#A60">:tdi</span>)     <span style="color:#777"># =&gt; true</span>
</pre></div>
</div>
      </div>

      <p>Or called directly on the pin:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>pin(<span style="color:#A60">:tdi</span>).add_alias(<span style="color:#A60">:bisti</span>)
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Defining_Pin_Groups"></a>          
  <h4><a href="#Defining_Pin_Groups">Defining Pin Groups</a></h4>          
</div>

      <p>Pin groups are modelled by an object called a <a href="/origen/api/Origen/Pins/PinCollection.html">PinCollection</a>
which is very similar in principle to the BitCollection used for modelling registers.
A <a href="/origen/api/Origen/Pins/PinCollection.html">PinCollection</a> is essentially an extension of a regular Ruby
array object which has some of its own attributes (such as an id for example) and everything else is proxied to
the contained pin objects.</p>

      <p>For pattern generation pins and pin groups will support the same API so that application code does not have to
give much concern as to whether it is dealing with one or the other.</p>

      <p>Pin groups are defined in a similar manner to single pins:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>add_pins <span style="color:#A60">:porta</span>, <span style="color:#606">size</span>: <span style="color:#00D">32</span>
add_pins <span style="color:#A60">:portb</span>, <span style="color:#606">size</span>: <span style="color:#00D">16</span>, <span style="color:#606">endian</span>: <span style="color:#A60">:little</span>
</pre></div>
</div>
      </div>

      <p>Some points to note in the above code:</p>

      <ul>
<li>
<code>add_pins</code> will generate a new pin group, e.g. named <code>:porta</code> and individual pin
objects named <code>:porta0</code> through <code>:porta31</code>.
See below for how to define pin groups based on existing pins.</li>
        <li>Pin groups can be any size, define via the <code>:size</code> option.</li>
        <li>Pin groups are big endian by default, however little endian can be specified via the
<code>:endian</code> option. Changing this attribute will have the effect of reversing the
order that data is applied in a test pattern.</li>
      </ul>
<p>Pin groups can be looked up like regular pins, or via a dedicated method if it makes application code clearer:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>pins(<span style="color:#A60">:porta</span>)               <span style="color:#777"># =&gt; &lt;pin collection&gt;</span>
pin_group(<span style="color:#A60">:porta</span>)          <span style="color:#777"># =&gt; &lt;pin collection&gt;</span>
</pre></div>
</div>
      </div>

      <p>A pin group is a regular Ruby array and can be iterated on and so on:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>pins(<span style="color:#A60">:porta</span>).size          <span style="color:#777"># =&gt; 32</span>

pins(<span style="color:#A60">:porta</span>).each <span style="color:#080;font-weight:bold">do</span> |pin|
  <span style="color:#777"># Do this for pin :porta0, :porta1, etc.</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>Within a pin group individual pins can be addressed via a local index:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>pins(<span style="color:#A60">:porta</span>)[<span style="color:#00D">0</span>] == pins(<span style="color:#A60">:porta0</span>)   <span style="color:#777"># =&gt; true</span>
</pre></div>
</div>
      </div>

      <p>Anonymous pin groups can be composed from a range of indexes at runtime:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>pins(<span style="color:#A60">:porta</span>).data                 <span style="color:#777"># =&gt; 0x0000_0000</span>
pins(<span style="color:#A60">:porta</span>)[<span style="color:#00D">0</span>,<span style="color:#00D">1</span>,<span style="color:#00D">2</span>,<span style="color:#00D">3</span>].drive(<span style="color:#00D">0xF</span>)
pins(<span style="color:#A60">:porta</span>).data                 <span style="color:#777"># =&gt; 0x0000_000F</span>
pins(<span style="color:#A60">:porta</span>)[<span style="color:#00D">8</span>..<span style="color:#00D">15</span>].drive(<span style="color:#00D">0x55</span>)
pins(<span style="color:#A60">:porta</span>).data                 <span style="color:#777"># =&gt; 0x0000_550F  </span>
</pre></div>
</div>
      </div>

      <p>Pin groups can be composed from any arbitrary group of existing pins using the <code>add_pin_group</code> method:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># The first argument is the ID for the new pin group, followed by the IDs of the pins it should contain</span>
add_pin_group <span style="color:#A60">:jtag</span>, <span style="color:#A60">:tdi</span>, <span style="color:#A60">:tdo</span>, <span style="color:#A60">:tclk</span>, <span style="color:#A60">:tms</span>

pins(<span style="color:#A60">:jtag</span>).size   <span style="color:#777"># =&gt; 4</span>
</pre></div>
</div>
      </div>

      <p>Pin groups can be aliased in the same way as pins, for readability the method <code>add_pin_group_alias</code>
can be used, although internally it is the same as <code>add_pin_alias</code>:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>add_pin_group_alias <span style="color:#A60">:porta</span>, <span style="color:#A60">:data</span>

pin_group(<span style="color:#A60">:data</span>).dont_care  <span style="color:#777"># Can now be used as if it were a regular first class pin group</span>
</pre></div>
</div>
      </div>

      <p>It is possible to alias a single pin within a pin group, in that case a pin number argument
must be supplied to <code>add_pin_alias</code>:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>add_pin_alias <span style="color:#A60">:moda</span>, <span style="color:#A60">:porta</span>, <span style="color:#606">pin</span>: <span style="color:#00D">4</span>
</pre></div>
</div>
      </div>

      <p>It is also possible to create a pin group from a subset of pins of a regular pin group, simply
pass in a range or an array of pin indexes to <code>add_pin_group_alias</code>:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>add_pin_group_alias <span style="color:#A60">:data_byte_0</span>, <span style="color:#A60">:porta</span>, <span style="color:#606">pins</span>: [<span style="color:#00D">7</span>..<span style="color:#00D">0</span>]
add_pin_group_alias <span style="color:#A60">:data_byte_1</span>, <span style="color:#A60">:porta</span>, <span style="color:#606">pins</span>: [<span style="color:#00D">8</span>,<span style="color:#00D">9</span>,<span style="color:#00D">10</span>,<span style="color:#00D">11</span>,<span style="color:#00D">12</span>,<span style="color:#00D">13</span>,<span style="color:#00D">14</span>,<span style="color:#00D">15</span>]

port(<span style="color:#A60">:data_byte_0</span>).dont_care  <span style="color:#777"># Can now be used as if it were a regular first class pin group</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Power_and_Ground_Pin_Modelling"></a>          
  <h4><a href="#Power_and_Ground_Pin_Modelling">Power and Ground Pin Modelling</a></h4>          
</div>

      <p>The API supports modelling power and ground pins as follows:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>add_pin <span style="color:#A60">:pinx</span>

add_power_pin <span style="color:#A60">:vdd1</span>
add_power_pin <span style="color:#A60">:vdd2</span>

add_ground_pin <span style="color:#A60">:gnd1</span>
add_ground_pin <span style="color:#A60">:gnd2</span>
add_ground_pin <span style="color:#A60">:gnd3</span>

add_power_pin_group <span style="color:#A60">:vdd</span>, <span style="color:#A60">:vdd1</span>, <span style="color:#A60">:vdd2</span>

add_ground_pin_group <span style="color:#A60">:gnd</span>, <span style="color:#A60">:gnd1</span>, <span style="color:#A60">:gnd2</span>, <span style="color:#A60">:gnd3</span>
</pre></div>
</div>
      </div>

      <p>This will cause these pins to be stored in separate collections to make pattern and other content generation easier:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># Based on the above example</span>
pins.size           <span style="color:#777"># =&gt; 1</span>
power_pins.size     <span style="color:#777"># =&gt; 2</span>
ground_pins.size    <span style="color:#777"># =&gt; 3</span>
</pre></div>
</div>
      </div>

      <p>Power and ground pin lookup should be done via dedicated methods:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>power_pin(<span style="color:#A60">:vdd1</span>)
ground_pins(<span style="color:#A60">:gnd</span>)

ground_pin_groups.each <span style="color:#080;font-weight:bold">do</span> |id, group|
  <span style="color:#777"># Do this for each ground pin group</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Changing_Data_State"></a>          
  <h4><a href="#Changing_Data_State">Changing Data State</a></h4>          
</div>

      <p>See the <a href="/origen/api/Origen/Pins/Pin.html">Pin API</a>
for full details of what methods are available.</p>

      <p>Here are a few examples of working with pins:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># Make the tester drive a value on a pin</span>
pin(<span style="color:#A60">:tdi</span>).drive_hi

<span style="color:#777"># Equivalent to above, this form is better when serially applying data in a loop...</span>
pin(<span style="color:#A60">:tdi</span>).drive(<span style="color:#00D">1</span>)  
<span style="color:#777"># ...like this...</span>
reg(<span style="color:#A60">:data</span>).shift_out_left <span style="color:#080;font-weight:bold">do</span> |bit|
  pin(<span style="color:#A60">:porta</span>).drive(bit.data)
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#777"># Asserting that a pin drives a certain value has various aliases, these are all equivalent</span>
pin(<span style="color:#A60">:tdo</span>).assert(<span style="color:#00D">1</span>)
pin(<span style="color:#A60">:tdo</span>).compare(<span style="color:#00D">1</span>)
pin(<span style="color:#A60">:tdo</span>).expect(<span style="color:#00D">1</span>)

<span style="color:#777"># Current state can be queried</span>
pin(<span style="color:#A60">:tdo</span>).driving?    <span style="color:#777"># false</span>
pin(<span style="color:#A60">:tdo</span>).comparing?  <span style="color:#777"># true</span>
pin(<span style="color:#A60">:tdo</span>).dont_care
pin(<span style="color:#A60">:tdo</span>).comparing?  <span style="color:#777"># false</span>

pin(<span style="color:#A60">:tms</span>).drive_lo
pin(<span style="color:#A60">:tms</span>).toggle

<span style="color:#777"># Pin groups support the same methods as pins</span>
port(<span style="color:#A60">:porta</span>).drive(<span style="color:#00D">0x55</span>)   <span style="color:#777"># 01010101</span>
port(<span style="color:#A60">:porta</span>).assert(<span style="color:#00D">0x55</span>)  <span style="color:#777"># LHLHLHLH</span>
port(<span style="color:#A60">:porta</span>).dont_care     <span style="color:#777"># XXXXXXXX</span>

<span style="color:#777"># Individual pins within a pin group can be accessed by index</span>
port(<span style="color:#A60">:porta</span>)[<span style="color:#00D">1</span>].drive(<span style="color:#00D">0</span>)   <span style="color:#777"># XXXXXX0X</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Bang_(!)_Methods"></a>          
  <h4><a href="#Bang_(!)_Methods">Bang (!) Methods</a></h4>          
</div>

      <p>Almost all pin methods have a bang form, for example:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>pin(<span style="color:#A60">:tdi</span>).drive!(<span style="color:#00D">1</span>)
</pre></div>
</div>
      </div>

      <p>The bang methods will set the state on the pin in the same way as the regular method but
will then automatically fire off a tester cycle to generate a vector.</p>

      <p>In other words the above is the shorthand equivalent of:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>pin(<span style="color:#A60">:tdi</span>).drive(<span style="color:#00D">1</span>)
<span style="color:#d70">$tester</span>.cycle
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Pin_Availability_by_Package"></a>          
  <h4><a href="#Pin_Availability_by_Package">Pin Availability by Package</a></h4>          
</div>

      <p>Pins can be defined based on a specific <a href="/origen/guides/models/modes/#Package">package context</a>
which can be used to gate their availability.</p>

      <p>Here is an example:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># Initially define the available packages at the top level before adding any pins</span>

<span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MySoC</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">TopLevel</span>

  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>
    add_package <span style="color:#A60">:pkg1</span>
    add_package <span style="color:#A60">:pkg2</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <p>Pins can then be defined by package:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>add_pin <span style="color:#A60">:pin1</span>, <span style="color:#606">packages</span>: <span style="color:#A60">:all</span>
add_pin <span style="color:#A60">:pin2</span>                           <span style="color:#777"># No constraint is equivalent to :all</span>
add_pin <span style="color:#A60">:pin3</span>, <span style="color:#606">package</span>: <span style="color:#A60">:pkg2</span>
add_pin <span style="color:#A60">:pin4</span>, <span style="color:#606">packages</span>: [<span style="color:#A60">:pkg1</span>, <span style="color:#A60">:pkg2</span>]

<span style="color:#777"># Pins can also be added within a package scope, these will add to :pkg1 only</span>
with_package <span style="color:#A60">:pkg1</span> <span style="color:#080;font-weight:bold">do</span>
  add_pin <span style="color:#A60">:pin5</span>
  add_pin <span style="color:#A60">:pin6</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#777"># All pins are available when the package is set to nil, no package represents the die</span>
package              <span style="color:#777"># =&gt; nil</span>
pins.size            <span style="color:#777"># =&gt; 6</span>
package = <span style="color:#A60">:pkg1</span>
pins.size            <span style="color:#777"># =&gt; 5 (no pin3)</span>
has_pin?(<span style="color:#A60">:pin3</span>)      <span style="color:#777"># =&gt; false</span>
package = <span style="color:#A60">:pkg2</span>
pins.size            <span style="color:#777"># =&gt; 4 (no pin5 or pin6)</span>
has_pin?(<span style="color:#A60">:pin3</span>)      <span style="color:#777"># =&gt; true</span>
</pre></div>
</div>
      </div>

      <p>Pin groups can contain different sets of pins in different packages:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>add_pin(<span style="color:#A60">:pin1</span>)
add_pin(<span style="color:#A60">:pin2</span>)
add_pin(<span style="color:#A60">:pin3</span>)

add_pin_group <span style="color:#A60">:g1</span>, <span style="color:#A60">:pin1</span>, <span style="color:#A60">:pin2</span>,        <span style="color:#606">package</span>: <span style="color:#A60">:pkg1</span>
add_pin_group <span style="color:#A60">:g1</span>, <span style="color:#A60">:pin1</span>, <span style="color:#A60">:pin2</span>, <span style="color:#A60">:pin3</span>, <span style="color:#606">package</span>: <span style="color:#A60">:pkg2</span>

has_pins?(<span style="color:#A60">:g1</span>)      <span style="color:#777"># =&gt; false</span>
pin_groups.size     <span style="color:#777"># =&gt; 0</span>

package = <span style="color:#A60">:pkg1</span>
has_pins?(<span style="color:#A60">:g1</span>)      <span style="color:#777"># =&gt; true</span>
pins(<span style="color:#A60">:g1</span>).size      <span style="color:#777"># =&gt; 2</span>
pin_groups.size     <span style="color:#777"># =&gt; 1</span>

package = <span style="color:#A60">:pkg2</span>
has_pins?(<span style="color:#A60">:g1</span>)      <span style="color:#777"># =&gt; true</span>
pins(<span style="color:#A60">:g1</span>).size      <span style="color:#777"># =&gt; 3</span>
pin_groups.size     <span style="color:#777"># =&gt; 1</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Package_Attributes"></a>          
  <h4><a href="#Package_Attributes">Package Attributes</a></h4>          
</div>

      <p>The attributes listed in the constant <code>PACKAGE_SCOPED_ATTRIBUTES</code> in the <a href="/origen/api/Origen/Pins/Pin.html">Pin API</a>
can be set to specific values per package.</p>

      <p>Here is an example of how to set the pin location by package:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># At definition time</span>
add_pin <span style="color:#A60">:pin1</span>, <span style="color:#606">packages</span>: {<span style="color:#606">pkg1</span>: {<span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">A2</span><span style="color:#710">"</span></span>}, <span style="color:#606">pkg2</span>: {<span style="color:#606">location</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">A3</span><span style="color:#710">"</span></span>}}
add_pin <span style="color:#A60">:pin2</span>

<span style="color:#777"># Or later</span>
pins(<span style="color:#A60">:pin2</span>).add_location <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">A5</span><span style="color:#710">"</span></span>, <span style="color:#606">package</span>: <span style="color:#A60">:pkg1</span>
pins(<span style="color:#A60">:pin2</span>).add_location <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">B2</span><span style="color:#710">"</span></span>, <span style="color:#606">package</span>: <span style="color:#A60">:pkg2</span>

package = <span style="color:#A60">:pkg1</span>
pins(<span style="color:#A60">:pin1</span>).location       <span style="color:#777"># =&gt; "A2"</span>
pins(<span style="color:#A60">:pin2</span>).location       <span style="color:#777"># =&gt; "A5"</span>

package = <span style="color:#A60">:pkg2</span>
pins(<span style="color:#A60">:pin1</span>).location       <span style="color:#777"># =&gt; "A3"</span>
pins(<span style="color:#A60">:pin2</span>).location       <span style="color:#777"># =&gt; "B2"</span>
</pre></div>
</div>
      </div>

      <p>A context can also be supplied when reading such attributes to override the current context:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>package = <span style="color:#A60">:pkg1</span>
pins(<span style="color:#A60">:pin1</span>).location                   <span style="color:#777"># =&gt; "A2"</span>
pins(<span style="color:#A60">:pin1</span>).location(<span style="color:#606">package</span>: <span style="color:#A60">:pkg2</span>)   <span style="color:#777"># =&gt; "A3"</span>
</pre></div>
</div>
      </div>

      <p>Origen will automatically create an alias for the given location (a lower cased symbol) that is scoped to the package.</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>package = <span style="color:#A60">:pkg1</span>
has_pin?(<span style="color:#A60">:a2</span>)              <span style="color:#777"># =&gt; true</span>
has_pin?(<span style="color:#A60">:a3</span>)              <span style="color:#777"># =&gt; false</span>
package = <span style="color:#A60">:pkg2</span>
has_pin?(<span style="color:#A60">:a2</span>)              <span style="color:#777"># =&gt; false</span>
has_pin?(<span style="color:#A60">:a3</span>)              <span style="color:#777"># =&gt; true</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Pin_Functions"></a>          
  <h4><a href="#Pin_Functions">Pin Functions</a></h4>          
</div>

      <p>Pin aliases are an example of modelling different pin functions that can be mux’d onto the same pin, in this case
the pin attributes are the same regardless of the function name being used.</p>

      <p>However sometimes it is necessary to model different attributes depending on the pin function - for example under
one function the pin may be an input, but when used as another function it is an output.</p>

      <p>The attributes listed in the constant <code>FUNCTION_SCOPED_ATTRIBUTES</code> in the <a href="/origen/api/Origen/Pins/Pin.html">Pin API</a>
can be set to specific values per context (mode and/or configuration).</p>

      <p>Here is an example of adding a function:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MySoC</span>
  include <span style="color:#036;font-weight:bold">Origen</span>::<span style="color:#036;font-weight:bold">TopLevel</span>

  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>
    add_pin <span style="color:#A60">:pin1</span>
    add_pin <span style="color:#A60">:pin2</span>

    <span style="color:#777"># Define some pin functions</span>
    pin(<span style="color:#A60">:pin1</span>).add_function <span style="color:#A60">:nvm_fail</span>, <span style="color:#606">direction</span>: <span style="color:#A60">:output</span>
    pin(<span style="color:#A60">:pin2</span>).add_function <span style="color:#A60">:nvm_done</span>, <span style="color:#606">direction</span>: <span style="color:#A60">:output</span>
    pin(<span style="color:#A60">:pin1</span>).add_function <span style="color:#A60">:tdi</span>, <span style="color:#606">direction</span>: <span style="color:#A60">:input</span>
    pin(<span style="color:#A60">:pin2</span>).add_function <span style="color:#A60">:tdo</span>, <span style="color:#606">direction</span>: <span style="color:#A60">:output</span>

    <span style="color:#777"># Add some groupings that are associated with specific pin functions</span>
    add_pin_group <span style="color:#A60">:jtag</span>, <span style="color:#A60">:tdi</span>, <span style="color:#A60">:tdo</span>
    add_pin_group <span style="color:#A60">:nvm</span>,  <span style="color:#A60">:nvm_fail</span>, <span style="color:#A60">:nvm_done</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#d70">$dut</span> = <span style="color:#036;font-weight:bold">MySoC</span>.new

<span style="color:#777"># The name used to look up a pin now returns the pin with a thin wrapper around it</span>
<span style="color:#777"># which defines its current function:</span>
<span style="color:#d70">$dut</span>.pin(<span style="color:#A60">:nvm_fail</span>).direction    <span style="color:#777"># =&gt; :output</span>
<span style="color:#d70">$dut</span>.pin(<span style="color:#A60">:nvm_done</span>).direction    <span style="color:#777"># =&gt; :output</span>
<span style="color:#d70">$dut</span>.pin(<span style="color:#A60">:tdi</span>).direction         <span style="color:#777"># =&gt; :input</span>
<span style="color:#d70">$dut</span>.pin(<span style="color:#A60">:tdo</span>).direction         <span style="color:#777"># =&gt; :output</span>

<span style="color:#777"># If a function name is given when defining a pin group, the pin will always have</span>
<span style="color:#777"># that function when it is accessed through the resultant group</span>
<span style="color:#d70">$dut</span>.pins(<span style="color:#A60">:jtag</span>)[<span style="color:#00D">0</span>].direction    <span style="color:#777"># =&gt; :output</span>
<span style="color:#d70">$dut</span>.pins(<span style="color:#A60">:jtag</span>)[<span style="color:#00D">1</span>].direction    <span style="color:#777"># =&gt; :input</span>
<span style="color:#d70">$dut</span>.pins(<span style="color:#A60">:nvm</span>)[<span style="color:#00D">0</span>].direction     <span style="color:#777"># =&gt; :output</span>
<span style="color:#d70">$dut</span>.pins(<span style="color:#A60">:nvm</span>)[<span style="color:#00D">1</span>].direction     <span style="color:#777"># =&gt; :output</span>
</pre></div>
</div>
      </div>

      <div style="position: relative">
  <hr>
<div>    
  <a class="anchor" name="Comments"></a>          
  <h4><a href="#Comments">Comments</a></h4>          
</div>
</div>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'origen-sdk';
    var disqus_title;
    var disqus_url = 'http://' + window.location.hostname + window.location.pathname;

    disqus_title = $("h1").text();
    if (disqus_title.length == 0) {
      disqus_title = $("h2").text();
    }
    if (disqus_title.length == 0) {
      disqus_title = $("h3").text();
    }
    if (disqus_title.length == 0) {
      disqus_title = $("title").text();
    } else {
      disqus_title = disqus_title + ' (' + $("title").text() + ')';
    }

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>

    </article>
</div>
</div>

<script src="/origen/search.js"></script>
      </div><!-- /.container -->
    

    <footer class="footer">
      <div class="container">
        <p class="pull-left text-muted">
          Generated with the <a href="http://origen-sdk.org">Origen Semiconductor Developer's Kit</a>
        </p>
        <p class="pull-right text-muted">Origen is released under the terms of the <a href="http://choosealicense.com/licenses/lgpl-3.0/">LGPLv3</a></p>
      </div>
    </footer>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="http://origen-sdk.org/js/lunr.min.js"></script>
    <script src="http://origen-sdk.org/js/highlight.js"></script>
    <script src="http://origen-sdk.org/js/custom.js"></script>
  </body>
</html>
