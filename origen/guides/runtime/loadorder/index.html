<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>Origen - Guides</title>
        
    

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://origen-sdk.org/css/bootstrap_custom.css"></script>
    <!-- Load this up top to allow pages to execute JQuery snippets -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
        ga('create', 'UA-64455560-1', 'auto');
        ga('send', 'pageview');
      </script>
    

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="http://origen-sdk.org/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://origen-sdk.org/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://origen-sdk.org/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://origen-sdk.org/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://origen-sdk.org/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://origen-sdk.org/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://origen-sdk.org/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="http://origen-sdk.org/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="http://origen-sdk.org/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://origen-sdk.org/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="http://origen-sdk.org/manifest.json">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
  </head>

  <body>
    
      <div class="container">
        <nav class="navbar navbar-inverse navbar-fixed-top"><div class="container">
    <div class="navbar-header">
      <a href="/" class="navbar-brand" style="margin-top: -4px;">
        <img src="http://origen-sdk.org/img/origen-device.png" style="height:30px; margin-right: 2px; display: inline; margin-top: -2px;"><img src="http://origen-sdk.org/img/origen-text.png" style="height:15px; display: inline;"></a>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
<li class="dropdown ">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="tour">Tour <span class="caret"></span></a>
          <ul class="dropdown-menu" aria-labelledby="tour">
<li><a href="/origen/tour/basics">Basics</a></li>
            <li class="divider">
            </li>
<li><a href="/origen/tour/test-engineering">Test Engineers</a></li>
            <li><a href="/origen/tour/design-engineering">Design Engineers</a></li>
          </ul>
</li>
        <li class="active"><a href="/origen/guides/starting/introduction">Guides</a></li>
        <li class=""><a href="/origen/api">API</a></li>
        <li class=""><a href="https://github.com/Origen-SDK">Github</a></li>
        <li class=""><a href="/origen/community">Community</a></li>
        <li class=""><a href="/origen/release_notes">Release Notes</a></li>
        <li class=""><a href="/origen/plugins">Plugins</a></li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
</nav><div class="row">
  <div class="col-md-3 sidebar-nav-container">
    <div class="well sidebar-nav" style="margin-top: 20px;">
        <div id="search">
          <form style="margin-bottom: 15px;">
            <div class="input-group">
              <input class="form-control" type="search" placeholder="Search these docs..."><span class="input-group-btn">
                <button type="submit" class="btn btn-search">GO!</button>
              </span>
            </div>
          </form>
        </div>
        <div class="panel-group" id="sidebar-accordion">

          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-0">
              <a class="no-underline">
                Getting Started with Origen
              </a>
            </div>
            <div id="sidebar-collapse-0" class="panel-collapse collapse ">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/starting/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/starting/core">Core concepts</a></li>
<li class=""><a href="/origen/guides/starting/installing">How to Install</a></li>
<li class=""><a href="/origen/guides/starting/installwin">How to Install (Windows)</a></li>
<li class=""><a href="/origen/guides/starting/company">Company Customization</a></li>
<li class=""><a href="/origen/guides/starting/gems">Understanding Gems</a></li>
<li class=""><a href="/origen/guides/starting/app">Creating a New App</a></li>
<li class=""><a href="/origen/guides/starting/commit">The Initial Commit</a></li>
                </ul>
</div>
            </div>
          </div>
          <div class="panel panel-default">
            <div class="panel-heading clickable" data-toggle="collapse" data-parent="#sidebar-accordion" href="#sidebar-collapse-1">
              <a class="no-underline">
                Runtime Environment
              </a>
            </div>
            <div id="sidebar-collapse-1" class="panel-collapse collapse in">
              <div class="panel-body">
                <ul class="nav nav-list">
<li class=""><a href="/origen/guides/runtime/introduction">Introduction</a></li>
<li class=""><a href="/origen/guides/runtime/mode">Mode</a></li>
<li class=""><a href="/origen/guides/runtime/environment">Environment</a></li>
<li class=""><a href="/origen/guides/runtime/target">Target</a></li>
<li class=""><a href="/origen/guides/runtime/production">Production Targets</a></li>
<li class=""><a href="/origen/guides/runtime/global">Global Setup</a></li>
<li class="active"><a href="/origen/guides/runtime/loadorder">Load Order</a></li>
<li class=""><a href="/origen/guides/runtime/programming">Programming</a></li>
                </ul>
</div>
            </div>
          </div>
      

        </div>

    </div>
  </div>

  <div class="col-md-9 nav-page-container">
    <article><h3 class="topic-title">Runtime Environment</h3>

      <h2 class="topic-subtitle">Load Order</h2>

      <hr>
<p>The number of global objects instantiated by a runtime environment should be kept to a minimum,
however even the most basic of setups is likely to instantiate both a <code>$dut</code>
and a <code>$tester</code> object.</p>

      <p>It is important that the initialization of each of these objects does not depend on the other
to avoid introducing a dependency on the order in which they must be instantiated.
Such a dependency is fine when the application is young and the number of configurations is small, but as
it grows this can become painful to manage and hard to anticipate when new engineers
come onto the team.</p>

      <p>Nonetheless it is very likely that sooner or later the case will arise where an object
must be initially configured differently depending on what tester platform it is
running on, or on what top-level device object it has been integrated into.</p>

      <p>So how to do that initial configuration without introducing an instantiation
order dependency?</p>

      <p>The answer is to use an <code>on_create</code> method to complete any initialization
operations that depend on other objects.</p>

      <div>    
  <a class="anchor" name="Using_on_create"></a>          
  <h4><a href="#Using_on_create">Using on_create</a></h4>          
</div>

      <p><code>on_create</code> is an Origen callback
and the <a href="/origen/guides/custom/callbacks">callback guide</a> should be consulted 
for background information and for details on how to setup your model to use callbacks.</p>

      <p>Whenever Origen loads a runtime environment it will automatically call the <code>on_create</code>
methods of any objects that have just come into being at the end of loading the target/environment files.</p>

      <p>It is therefore guaranteed that <code>on_create</code> will be run before any
operations are invoked on the model outside of the target/environment files and it should be though of
as similar to the standard Ruby <code>initialize</code> method but with the guarantee
that all runtime objects already exist by the time it is called.</p>

      <p>Here are some examples of cases where <code>on_create</code> should be used in
preference to <code>initialize</code>:</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># In the $dut model</span>
<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>
  <span style="color:#777"># This would be creating an instantiation order dependency by doing this here,</span>
  <span style="color:#777"># i.e. $tester must exist before the $dut</span>
  <span style="color:#777"># $tester.do_something</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">on_create</span>
  <span style="color:#777"># But not here</span>
  <span style="color:#d70">$tester</span>.do_something
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#777"># In a model that is not $dut</span>
<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>
  <span style="color:#777"># This would be creating an instantiation order dependency by doing this here,</span>
  <span style="color:#777"># i.e. $dut must exist before this model</span>
  <span style="color:#777"># if $dut.test_pin_muxed_with_reset?</span>
  <span style="color:#777">#   add_pin_alias :test, :reset</span>
  <span style="color:#777"># else</span>
  <span style="color:#777">#   add_pin :test</span>
  <span style="color:#777"># end</span>
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">on_create</span>
  <span style="color:#777"># But not here</span>
  <span style="color:#080;font-weight:bold">if</span> <span style="color:#d70">$dut</span>.test_pin_muxed_with_reset?
    add_pin_alias <span style="color:#A60">:test</span>, <span style="color:#A60">:reset</span>
  <span style="color:#080;font-weight:bold">else</span>
    add_pin <span style="color:#A60">:test</span>
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div>    
  <a class="anchor" name="Any_Downside_to_Using_on_create_Instead_of_initialize?"></a>          
  <h4><a href="#Any_Downside_to_Using_on_create_Instead_of_initialize?">Any Downside to Using on_create Instead of initialize?</a></h4>          
</div>

      <p>Not really.</p>

      <p>Using <code>initialize</code> for object construction/initialization is perhaps preferable in some
sense since it is a standard Ruby method and therefore clearer for someone new to Origen
to understand how the model is initially being configured.</p>

      <p>However generally anything that can be done in <code>initialize</code> can be safely
moved to <code>on_create</code> and the eventual state of the model instantiated by the
runtime environment files will be identical.</p>

      <p>One major difference is that parameter options cannot be passed into <code>on_create</code>
from the target, whereas options can be passed into the <code>initialize</code> method.
Such parameter dependent cases can still be moved to <code>on_create</code> but the
options will need to be saved by the <code>initialize</code> method.</p>

      <div class="highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre><span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">initialize</span>(options={})
  <span style="color:#33B">@intial_options</span> = options
<span style="color:#080;font-weight:bold">end</span>

<span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">on_create</span>
  <span style="color:#080;font-weight:bold">if</span> <span style="color:#33B">@intial_options</span>[<span style="color:#A60">:uti</span>]
    <span style="color:#d70">$tester</span>.do_something
  <span style="color:#080;font-weight:bold">end</span>
<span style="color:#080;font-weight:bold">end</span>
</pre></div>
</div>
      </div>

      <div style="position: relative">
  <hr>
<div>    
  <a class="anchor" name="Comments"></a>          
  <h4><a href="#Comments">Comments</a></h4>          
</div>
</div>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'origen-sdk';
    var disqus_title;
    var disqus_url = 'http://' + window.location.hostname + window.location.pathname;

    disqus_title = $("h1").text();
    if (disqus_title.length == 0) {
      disqus_title = $("h2").text();
    }
    if (disqus_title.length == 0) {
      disqus_title = $("h3").text();
    }
    if (disqus_title.length == 0) {
      disqus_title = $("title").text();
    } else {
      disqus_title = disqus_title + ' (' + $("title").text() + ')';
    }

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>

    </article>
</div>
</div>

<script src="/origen/search.js"></script>
      </div><!-- /.container -->
    

    <footer class="footer">
      <div class="container">
        <p class="pull-left text-muted">
          Generated with the <a href="http://origen-sdk.org">Origen Semiconductor Developer's Kit</a>
        </p>
        <p class="pull-right text-muted">Origen is released under the terms of the <a href="http://choosealicense.com/licenses/lgpl-3.0/">LGPLv3</a></p>
      </div>
    </footer>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="http://origen-sdk.org/js/lunr.min.js"></script>
    <script src="http://origen-sdk.org/js/highlight.js"></script>
    <script src="http://origen-sdk.org/js/custom.js"></script>
  </body>
</html>
